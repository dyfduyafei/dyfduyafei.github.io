<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Hello World</title>
    <url>/posts/16107/</url>
    <content><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><p><img src="/../assets/img/index.jpg" alt="index.jpg"><img src="/" alt="image.png"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>
]]></content>
  </entry>
  <entry>
    <title>linuxæœåŠ¡å™¨å…å¯†ç ç™»å½•</title>
    <url>/posts/42537/</url>
    <content><![CDATA[<h1 id="linuxæœåŠ¡å™¨å…å¯†ç ç™»å½•"><a href="#linuxæœåŠ¡å™¨å…å¯†ç ç™»å½•" class="headerlink" title="linuxæœåŠ¡å™¨å…å¯†ç ç™»å½•"></a>linuxæœåŠ¡å™¨å…å¯†ç ç™»å½•</h1><h2 id="1-linuxä¸‹ç”Ÿæˆç§˜é’¥"><a href="#1-linuxä¸‹ç”Ÿæˆç§˜é’¥" class="headerlink" title="1.linuxä¸‹ç”Ÿæˆç§˜é’¥"></a>1.linuxä¸‹ç”Ÿæˆç§˜é’¥</h2><p>####ssh-keygen -t rsa</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">@default âœ ~  ssh-keygen -t rsa</span><br><span class="line">Generating public/private rsa key pair.</span><br><span class="line">Enter file in which to save the key (/root/.ssh/id_rsa): </span><br><span class="line">Created directory &#x27;/root/.ssh&#x27;.</span><br><span class="line">Enter passphrase (empty for no passphrase): </span><br><span class="line">Enter same passphrase again: </span><br><span class="line">Your identification has been saved in /root/.ssh/id_rsa.</span><br><span class="line">Your public key has been saved in /root/.ssh/id_rsa.pub.</span><br><span class="line">The key fingerprint is:</span><br><span class="line">SHA256:XXcSsHNjeEG6HxRL4C1X0Fo1WhxTedZelP7f4ZAGMPA root@default</span><br><span class="line">The key&#x27;s randomart image is:</span><br><span class="line">+---[RSA 2048]----+</span><br><span class="line">|       ..   o+OO%|</span><br><span class="line">|        .o . *oXX|</span><br><span class="line">|         Eo O.&amp;=+|</span><br><span class="line">|         . o @.=.|</span><br><span class="line">|        S . o o .|</span><br><span class="line">|             = o.|</span><br><span class="line">|            . + +|</span><br><span class="line">|               .o|</span><br><span class="line">|                 |</span><br><span class="line">+----[SHA256]-----+</span><br></pre></td></tr></table></figure>

<h4 id="ç”Ÿæˆä¸¤ä¸ªæ–‡ä»¶-id-rsaå’Œid-rsa-pub"><a href="#ç”Ÿæˆä¸¤ä¸ªæ–‡ä»¶-id-rsaå’Œid-rsa-pub" class="headerlink" title="ç”Ÿæˆä¸¤ä¸ªæ–‡ä»¶ id_rsaå’Œid_rsa.pub"></a>ç”Ÿæˆä¸¤ä¸ªæ–‡ä»¶ id_rsaå’Œid_rsa.pub</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">@default âœ ~  cd .ssh </span><br><span class="line">@default âœ .ssh  ll</span><br><span class="line">æ€»ç”¨é‡ 8.0K</span><br><span class="line">-rw-------. 1 root root 1.7K 1æœˆ   6 11:45 id_rsa</span><br><span class="line">-rw-r--r--. 1 root root  394 1æœˆ   6 11:45 id_rsa.pub</span><br></pre></td></tr></table></figure>

<h4 id="æŸ¥çœ‹ä¸‹id-rsa-pubçš„å†…å®¹"><a href="#æŸ¥çœ‹ä¸‹id-rsa-pubçš„å†…å®¹" class="headerlink" title="æŸ¥çœ‹ä¸‹id_rsa.pubçš„å†…å®¹"></a>æŸ¥çœ‹ä¸‹id_rsa.pubçš„å†…å®¹</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">@default âœ .ssh  cat id_rsa.pub </span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCamZj1xxoT0dc5aUAJ3cxmOmgtovlfi6PNoqlY371AP4f3ckksEm5Yuffge8BoqQsX2uYwrh6APRu4ZVSMqtg3aKbeLp99mKP6tX7+Plscz67T29T9MkkfbTG3x6S7/H0+aTyGDg4wLhls20mTdKHrki+Gq8CYzOIrYuto2amfXEEMDzMQvODS+VW+aXozOK4NhCkgtRCNMOvrwRdpJH8ixpiJZXrweVJQZ5DxVfEw2vDKMEau1PSp23Jp33CL/ImXCIsi65StBZbEFux5ot05CYaacze4Ddy1ewrzcCWJuqfU0Sl2qSRANMSUt3NtmdUKlH/sbjuExxdLA3i8tRVz root@default</span><br></pre></td></tr></table></figure>

<h4 id="æŸ¥çœ‹ä¸‹id-rsaçš„å†…å®¹"><a href="#æŸ¥çœ‹ä¸‹id-rsaçš„å†…å®¹" class="headerlink" title="æŸ¥çœ‹ä¸‹id_rsaçš„å†…å®¹"></a>æŸ¥çœ‹ä¸‹id_rsaçš„å†…å®¹</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">@default âœ .ssh  cat id_rsa</span><br><span class="line">-----BEGIN RSA PRIVATE KEY-----</span><br><span class="line">MIIEpAIBAAKCAQEAmpmY9ccaE9HXOWlACd3MZjpoLaL5X4ujzaKpWN+9QD+H93JJ</span><br><span class="line">LBJuWLn34HvAaKkLF9rmMK4egD0buGVUjKrYN2im3i6ffZij+rV+/j5bHM+u09vU</span><br><span class="line">/TJJH20xt8eku/x9Pmk8hg4OMC4ZbNtJk3Sh65IvhqvAmMziK2LraNmpn1xBDA8z</span><br><span class="line">ELzg0vlVvml6MziuDYQpILUQjTDr68EXaSR/IsaYiWV68HlSUGeQ8VXxMNrwyjBG</span><br><span class="line">rtT0qdtyad9wi/yJlwiLIuuUrQWWxBbseaLdOQmGmnM3uA3ctXsK83Alibqn1NEp</span><br><span class="line">dqkkQDTElLdzbZnVCpR/7G47hMcXSwN4vLUVcwIDAQABAoIBAH6CZF3zMI65b3KG</span><br><span class="line">gyXPv1yEPQ3jSEd8YG18xzF33Uj+9Ad0GRacennWrFWhTuEWO4Ko2SdKxKDR4KYz</span><br><span class="line">HU4C2+3zkGFOK6s+Ril5bdMlOa/I71pkkNUk2huCYmXuVAqU4fQ5b5KPW+LnRl0C</span><br><span class="line">0SF+FqZLuOJuF6uyNP2l89eYDirdsKEdHTUQFyk1FQn6yxxvTcgtAQbNTtT+94aj</span><br><span class="line">B2QyZSTusp6yBabLH94kFYm1sZYJTRs9tBRsZhF2P3LRkb/5Fo/L+v9QSeI/f7vB</span><br><span class="line">8mOiAwWPGl8HxhO0wWkZs7wyoYs4fCoDLPDX0qa/3bANKoc50x9kSnAbBXi0pgfQ</span><br><span class="line">J9A5QMkCgYEAyuQKwPbGlVu91dYPOetKpNx6rHNGdS7ZJw7fB7qOy26LkPMsnGzy</span><br><span class="line">E29tHAo37NhfNxi6I3MFiaTOwef1D1BU6lw8P1kudIyrMkxrIsDco86SKMs1yCgV</span><br><span class="line">S3nVu09o6sptZUsN4thJPlTsbEocDBTYbfEjnzQp+GyPRbSslLo+p00CgYEAwxGH</span><br><span class="line">zC6WTXvJA8WBq6fj58nwca9YOvXyUb3H40hALrPCPgDUzMV8PoY5Xl4v73esk7oH</span><br><span class="line">59TFakaVfWu38J4w3kAeMRt6vS2ODAbkm0+I9l0zNJgcFlyeOQmuO86ilKhU1qTv</span><br><span class="line">2fLxlsCDllB75UVOcKLIfMKSDbzAcX+gRDfrz78CgYEAvChkOLQjUlx0Xx1XnZUx</span><br><span class="line">8lZuhgOZ8g7yYCCQgfBngQ4R7Ok4FBGNJq0NeRWY69N16fjKlxmSpyXqgTWGtR8A</span><br><span class="line">wR+s1+rzBC94jPsF2IMXm+p07dQXGnrh1M82gbGRUT1N2sSSKi//LQlBAORxwlqK</span><br><span class="line">pNse+AQ+cB7td+2op31ZoXkCgYB8ZTSFR/w/gz3oMs6DafhTexrjVJ9eUjNqXy0W</span><br><span class="line">Sp/raGTpZ1xNDW8y7COvgz7sZhPezRZ3h98w67wvFD9jqW2efaMDS/PUqjVYhBjK</span><br><span class="line">1kiQW1TpKEtZE00vMHY024wgYsxfaSUvhtb7fN8tPzwTNERWXeiebvH24rSSbIIG</span><br><span class="line">nua5PwKBgQCqXp4lrVmjCIPXJTi5m/zVrUie9Q9syn2/0/hwLl7Eg6RgwzCjxdNN</span><br><span class="line">oUX0lgVBSFF+u0LoH4qxjAMt9qYjjcYKev6CGXDhsPklWGCBewfMNBI/p2oRzfqW</span><br><span class="line">yVVUJe6XFe2MQVLRHtbQyEfyPkQyLxmUEljF8CowGS1FPEFvFmFMkw==</span><br><span class="line">-----END RSA PRIVATE KEY-----</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/dyfSama/pic-bed/raw/master/md/image-20210113103645123.png" alt="image-20210113103645123"></p>
<h2 id="2-è¿œç¨‹å…å¯†ç™»å½•"><a href="#2-è¿œç¨‹å…å¯†ç™»å½•" class="headerlink" title="2.è¿œç¨‹å…å¯†ç™»å½•"></a>2.è¿œç¨‹å…å¯†ç™»å½•</h2><h4 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h4><p>ç®€å•çš„è¯´å°±æ˜¯Aç”Ÿæˆå…¬é’¥åæŠŠå…¬é’¥çš„ä¸²ï¼ˆå­—ç¬¦ä¸²ï¼‰æ·»åŠ åˆ°Bçš„authorized_keysæ–‡ä»¶ä¸­ã€‚</p>
<p>å¦å¤–è¦æ³¨æ„çš„æ˜¯æƒé™é—®é¢˜ã€‚.sshç›®å½•è¦700,authorized_keysæ–‡ä»¶è¦600ã€‚ä¹Ÿæœ‰è¯´æ˜¯755å’Œ655ç‚¹ï¼Œåæ­£åé¢ä¸¤ä¸ªä¸èƒ½æœ‰å†™æƒé™ã€‚</p>
<img src="https://gitee.com/dyfSama/pic-bed/raw/master/md/image-20210113103645504.png" alt="image-20210113103645504" style="zoom:80%;" />

<h5 id="æ–¹æ³•ä¸€"><a href="#æ–¹æ³•ä¸€" class="headerlink" title="æ–¹æ³•ä¸€"></a>æ–¹æ³•ä¸€</h5><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ssh-copy-id -i ~/.ssh/id_rsa.pub   ç”¨æˆ·å@ipåœ°å€</span><br></pre></td></tr></table></figure>

<h5 id="æ–¹æ³•äºŒ"><a href="#æ–¹æ³•äºŒ" class="headerlink" title="æ–¹æ³•äºŒ"></a>æ–¹æ³•äºŒ</h5><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">å…ˆ    scp ~/.ssh/id_dsa.pub ç”¨æˆ·å@IPåœ°å€:/tmp </span><br><span class="line">ç„¶å   cat /tmp/id_dsa.pub &gt;&gt; ~/.ssh/authorized_keys</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>linux</category>
      </categories>
      <tags>
        <tag>linux</tag>
        <tag>ssh</tag>
      </tags>
  </entry>
  <entry>
    <title>å•ä¾‹æ¨¡å¼</title>
    <url>/posts/46132/</url>
    <content><![CDATA[<h1 id="å•ä¾‹æ¨¡å¼"><a href="#å•ä¾‹æ¨¡å¼" class="headerlink" title="å•ä¾‹æ¨¡å¼"></a>å•ä¾‹æ¨¡å¼</h1><blockquote>
<p>å•ä¾‹æ¨¡å¼æ˜¯æŒ‡ç¡®ä¿ä¸€ä¸ªç±»åœ¨ä»»ä½•æƒ…å†µä¸‹éƒ½ç»å¯¹åªæœ‰ä¸€ä¸ªå®ä¾‹,å¹¶æä¾›ä¸€ä¸ªå…¨å±€è®¿é—®ç‚¹<br>å•ä¾‹æ¨¡å¼æ˜¯åˆ›å»ºå‹æ¨¡å¼</p>
</blockquote>
<h2 id="ç»“æ„å›¾"><a href="#ç»“æ„å›¾" class="headerlink" title="ç»“æ„å›¾"></a>ç»“æ„å›¾</h2><h2 id="é¥¿æ±‰å¼å•ä¾‹æ¨¡å¼"><a href="#é¥¿æ±‰å¼å•ä¾‹æ¨¡å¼" class="headerlink" title="é¥¿æ±‰å¼å•ä¾‹æ¨¡å¼"></a>é¥¿æ±‰å¼å•ä¾‹æ¨¡å¼</h2><p>é¥¿æ±‰å¼å•ä¾‹æ¨¡å¼åœ¨ç±»åŠ è½½çš„æ—¶å€™å°±ç«‹å³åˆå§‹åŒ–,å¹¶ä¸”åˆ›å»ºå•ä¾‹å¯¹è±¡ã€‚ç»å¯¹çº¿ç¨‹å®‰å…¨ï¼Œå†çº¿ç¨‹è¿˜æ²¡æœ‰å‡ºç°ä»¥å‰å°±å®ä¾‹åŒ–äº†ï¼Œ ä¸å¯èƒ½å­˜åœ¨è®¿é—®å®‰å…¨é—®é¢˜ã€‚</p>
<h3 id="é™æ€å˜é‡"><a href="#é™æ€å˜é‡" class="headerlink" title="é™æ€å˜é‡"></a>é™æ€å˜é‡</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HungrySingleton</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">HungrySingleton</span> <span class="variable">instance</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HungrySingleton</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">HungrySingleton</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> HungrySingleton <span class="title function_">getInstance</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="é™æ€ä»£ç å—"><a href="#é™æ€ä»£ç å—" class="headerlink" title="é™æ€ä»£ç å—"></a>é™æ€ä»£ç å—</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HungryStaticSingleton</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> HungryStaticSingleton instance;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        instance = <span class="keyword">new</span> <span class="title class_">HungryStaticSingleton</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">HungryStaticSingleton</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> HungryStaticSingleton <span class="title function_">getInstance</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>ğŸ“Œä¸ç®¡å¯¹è±¡ç”¨ä¸ä¸ç”¨éƒ½å ç€ç©ºé—´ï¼Œæµªè´¹å†…å­˜ã€‚</p>
</blockquote>
<h2 id="æ‡’æ±‰å¼å•ä¾‹æ¨¡å¼"><a href="#æ‡’æ±‰å¼å•ä¾‹æ¨¡å¼" class="headerlink" title="æ‡’æ±‰å¼å•ä¾‹æ¨¡å¼"></a>æ‡’æ±‰å¼å•ä¾‹æ¨¡å¼</h2><p>æ‡’æ±‰å¼å•ä¾‹æ¨¡å¼çš„ç‰¹ç‚¹æ˜¯ï¼Œå•ä¾‹å¯¹è±¡è¦åœ¨è¢«ä½¿ç”¨æ—¶æ‰ä¼šåˆå§‹åŒ–ã€‚</p>
<h3 id="ç®€å•æ¨¡å¼"><a href="#ç®€å•æ¨¡å¼" class="headerlink" title="ç®€å•æ¨¡å¼"></a>ç®€å•æ¨¡å¼</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Lazy001SimpleSingleton</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">Lazy001SimpleSingleton</span> <span class="variable">instance</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">Lazy001SimpleSingleton</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Lazy001SimpleSingleton <span class="title function_">getInstance</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (instance == <span class="literal">null</span>) &#123;</span><br><span class="line">             <span class="comment">// p1</span></span><br><span class="line">            instance = <span class="keyword">new</span> <span class="title class_">Lazy001SimpleSingleton</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>ğŸ“Œæ˜æ˜¾å­˜åœ¨çº¿ç¨‹å®‰å…¨é—®é¢˜<br>çº¿ç¨‹1åˆ›å»ºå¯¹è±¡æ—¶ï¼Œçº¿ç¨‹2ä¹Ÿå¯èƒ½è·‘åˆ°** p1**, ç»“æœå°±æ˜¯åˆ›å»ºä¸¤ä¸ªä¸åŒçš„å¯¹è±¡</p>
</blockquote>
<h3 id="ç®€å•åŒæ­¥"><a href="#ç®€å•åŒæ­¥" class="headerlink" title="ç®€å•åŒæ­¥"></a>ç®€å•åŒæ­¥</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Lazy002SyncSimpleSingleton</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">Lazy002SyncSimpleSingleton</span> <span class="variable">instance</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">Lazy002SyncSimpleSingleton</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// p1</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">static</span> Lazy002SyncSimpleSingleton <span class="title function_">getInstance</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (instance == <span class="literal">null</span>) &#123;</span><br><span class="line">            instance = <span class="keyword">new</span> <span class="title class_">Lazy002SyncSimpleSingleton</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>ğŸ“Œçº¿ç¨‹å®‰å…¨é—®é¢˜è§£å†³äº†ï¼Œ ä½†æ˜¯çº¿ç¨‹æ•°é‡æ¯”è¾ƒå¤šçš„æƒ…å†µä¸‹ï¼Œ ä¼šå¯¼è‡´å¤§é‡çº¿ç¨‹é˜»å¡åœ¨<strong>p1</strong>ï¼Œä»è€Œå¯¼è‡´ç¨‹åºæ€§èƒ½å¤§å¹…ä¸‹é™ã€‚</p>
</blockquote>
<h3 id="åŒé‡æ£€æŸ¥ï¼ˆDLCï¼‰"><a href="#åŒé‡æ£€æŸ¥ï¼ˆDLCï¼‰" class="headerlink" title="åŒé‡æ£€æŸ¥ï¼ˆDLCï¼‰"></a>åŒé‡æ£€æŸ¥ï¼ˆDLCï¼‰</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Lazy003DLCSingleton</span> &#123;</span><br><span class="line">    <span class="comment">// volatile è§£å†³æŒ‡ä»¤æ’åºé—®é¢˜</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">volatile</span> <span class="type">Lazy003DLCSingleton</span> <span class="variable">instance</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">Lazy003DLCSingleton</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Lazy003DLCSingleton <span class="title function_">getInstance</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// instanceæœ‰å€¼åï¼Œæ–°æ¥çš„çº¿ç¨‹ä¸ç”¨é˜»å¡ç›´æ¥è¿”å›</span></span><br><span class="line">        <span class="keyword">if</span> (instance == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">synchronized</span> (Lazy003DLCSingleton.class) &#123;</span><br><span class="line">                <span class="comment">// é¿å…é‡å¤åˆ›å»ºinstance</span></span><br><span class="line">                <span class="keyword">if</span> (instance == <span class="literal">null</span>) &#123;  <span class="comment">// p1</span></span><br><span class="line">                    instance = <span class="keyword">new</span> <span class="title class_">Lazy003DLCSingleton</span>();</span><br><span class="line">                    <span class="comment">// 1. åˆ†é…å†…å­˜ç»™è¿™ä¸ªå¯¹è±¡</span></span><br><span class="line">                    <span class="comment">// 2. åˆå§‹åŒ–å¯¹è±¡</span></span><br><span class="line">                    <span class="comment">// 3. è®¾ç½®instanceæŒ‡å‘åˆšåˆ†é…çš„å†…å­˜åœ°å€</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>ğŸ“Œä¸ºä»€ä¹ˆéœ€è¦volatileï¼š</p>
<p>æ­£å¸¸çš„åˆ›å»ºå¯¹è±¡æ—¶  1â†’ 2 â†’ 3ï¼Œ<br>ä½†æ˜¯å¦‚æœå‘ç”Ÿäº†cpuæŒ‡ä»¤æ’åºï¼Œå¯èƒ½æ˜¯ 1â†’ 3â†’2&#x20;<br>å‡å¦‚çº¿ç¨‹1åˆ›å»ºå¯¹è±¡æ‰§è¡Œåˆ° æ­¥éª¤1ã€æ­¥éª¤3ï¼Œè¿˜æ²¡æœ‰è¿›è¡Œå¯¹è±¡åˆå§‹åŒ–, è¿™æ—¶çº¿ç¨‹2 æ‰§è¡Œåˆ°p1 å°±ä¼šåˆ¤æ–­ instanceä¸ä¸ºç©ºï¼Œçº¿ç¨‹2 ç›´æ¥è¿”å›äº†ç©ºå¯¹è±¡ã€‚</p>
<p>ä½¿ç”¨volatile å¯ä»¥é¿å…æŒ‡ä»¤é‡æ’ï¼Œä¿è¯åˆ›å»ºå¯¹è±¡æ—¶  1â†’ 2 â†’ 3</p>
</blockquote>
<h3 id="é™æ€å†…éƒ¨ç±»"><a href="#é™æ€å†…éƒ¨ç±»" class="headerlink" title="é™æ€å†…éƒ¨ç±»"></a>é™æ€å†…éƒ¨ç±»</h3><p>DLCæ€»å½’è¦åŠ é”ï¼Œå¯¹ç¨‹åºæ€§èƒ½è¿˜æ˜¯å­˜åœ¨ä¸€å®šçš„å½±å“ã€‚ä»ç±»åˆå§‹åŒ–çš„è§’åº¦ï¼Œä½¿ç”¨é™æ€å†…éƒ¨ç±»çš„æ–¹å¼</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Lazy004InnerClassSingleton</span> &#123;</span><br><span class="line">    <span class="comment">// ä½¿ç”¨ Lazy004InnerClassSingleton  æ—¶ï¼Œ é»˜è®¤ä¼šå…ˆåˆå§‹åŒ–å†…éƒ¨ç±»</span></span><br><span class="line">    <span class="comment">// å¦‚æœæ²¡ä½¿ç”¨ï¼Œ åˆ™å†…éƒ¨ç±»æ˜¯ä¸åŠ è½½çš„</span></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">Lazy004InnerClassSingleton</span><span class="params">()</span> &#123;</span><br><span class="line">       </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// staticæ˜¯ä¸ºäº†å•ä¾‹çš„ç©ºé—´å…±äº«ï¼Œfinalä¿è¯è¿™ä¸ªæ–¹æ³•ä¸ä¼šè¢«é‡å†™ï¼Œé‡è½½</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> Lazy004InnerClassSingleton <span class="title function_">getInstance</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// è¿”å›ç»“æœå‰ï¼Œ ä¸€å®šä¼šå…ˆåŠ è½½å†…éƒ¨ç±»</span></span><br><span class="line">        <span class="keyword">return</span> LazyHolder.instance;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é»˜è®¤ä¸åŠ è½½</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">LazyHolder</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Lazy004InnerClassSingleton</span> <span class="variable">instance</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Lazy004InnerClassSingleton</span>();</span><br><span class="line">    &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>ğŸ“Œå…¼é¡¾é¥¿æ±‰å¼å•ä¾‹æ¨¡å¼çš„å†…å­˜æµªè´¹é—®é¢˜å’Œsynchronized çš„æ€§èƒ½é—®é¢˜<br>å†…éƒ¨ç±»ä¸€å®šæ˜¯è¦åœ¨æ–¹æ³•è°ƒç”¨ä¹‹å‰åˆå§‹åŒ–çš„,å·§å¦™çš„é¿å…äº†çº¿ç¨‹å®‰å…¨é—®é¢˜</p>
</blockquote>
<p>çœ‹ä¼¼æŒºå®Œç¾äº†ï¼Œå…¶å®è¿˜æ˜¯æœ‰é—®é¢˜</p>
<h4 id="åå°„ç ´åå•ä¾‹"><a href="#åå°„ç ´åå•ä¾‹" class="headerlink" title="åå°„ç ´åå•ä¾‹"></a>åå°„ç ´åå•ä¾‹</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LazySingletonTest</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException, </span><br><span class="line">    NoSuchMethodException, InvocationTargetException, InstantiationException,</span><br><span class="line">     IllegalAccessException &#123;</span><br><span class="line">     </span><br><span class="line">        Class&lt;Lazy004InnerClassSingleton&gt; clazz = Lazy004InnerClassSingleton.class;</span><br><span class="line">        Constructor&lt;Lazy004InnerClassSingleton&gt; c = clazz.getDeclaredConstructor(<span class="literal">null</span>);</span><br><span class="line">        </span><br><span class="line">        c.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="type">Object</span> <span class="variable">o1</span> <span class="operator">=</span> c.newInstance();</span><br><span class="line">        <span class="type">Object</span> <span class="variable">o2</span> <span class="operator">=</span> c.newInstance();</span><br><span class="line">        </span><br><span class="line">        System.out.println(<span class="number">01</span> == <span class="number">02</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="ä¼˜åŒ–ä¸€ä¸‹"><a href="#ä¼˜åŒ–ä¸€ä¸‹" class="headerlink" title="ä¼˜åŒ–ä¸€ä¸‹"></a>ä¼˜åŒ–ä¸€ä¸‹</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Lazy004InnerClassSingleton</span> &#123;</span><br><span class="line">    <span class="comment">// ä½¿ç”¨ Lazy004InnerClassSingleton  æ—¶ï¼Œ é»˜è®¤ä¼šå…ˆåˆå§‹åŒ–å†…éƒ¨ç±»</span></span><br><span class="line">    <span class="comment">// å¦‚æœæ²¡ä½¿ç”¨ï¼Œ åˆ™å†…éƒ¨ç±»æ˜¯ä¸åŠ è½½çš„</span></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">Lazy004InnerClassSingleton</span><span class="params">()</span> &#123;</span><br><span class="line">         <span class="keyword">if</span> (LazyHolder.instance != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;ä¸å…è®¸åˆ›å»ºå¤šä¸ªå®ä¾‹&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// staticæ˜¯ä¸ºäº†å•ä¾‹çš„ç©ºé—´å…±äº«ï¼Œfinalä¿è¯è¿™ä¸ªæ–¹æ³•ä¸ä¼šè¢«é‡å†™ï¼Œé‡è½½</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> Lazy004InnerClassSingleton <span class="title function_">getInstance</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// è¿”å›ç»“æœå‰ï¼Œ ä¸€å®šä¼šå…ˆåŠ è½½å†…éƒ¨ç±»</span></span><br><span class="line">        <span class="keyword">return</span> LazyHolder.instance;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é»˜è®¤ä¸åŠ è½½</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">LazyHolder</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Lazy004InnerClassSingleton</span> <span class="variable">instance</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Lazy004InnerClassSingleton</span>();</span><br><span class="line">    &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·å°±å®Œç¾äº†ã€‚</p>
]]></content>
      <categories>
        <category>è®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>è®¾è®¡æ¨¡å¼</tag>
        <tag>volatile</tag>
      </tags>
  </entry>
  <entry>
    <title>NPM-åŒ…ç®¡ç†å™¨</title>
    <url>/posts/411/</url>
    <content><![CDATA[<h1 id="NPM-åŒ…ç®¡ç†å™¨"><a href="#NPM-åŒ…ç®¡ç†å™¨" class="headerlink" title="NPM-åŒ…ç®¡ç†å™¨"></a>NPM-åŒ…ç®¡ç†å™¨</h1><h2 id="npmå®‰è£…"><a href="#npmå®‰è£…" class="headerlink" title="npmå®‰è£…"></a>npmå®‰è£…</h2><p>éšnodeå®‰è£…<code>nvm -v</code> æ˜¾ç¤ºç‰ˆæœ¬</p>
<h2 id="npmå¸¸ç”¨å‘½ä»¤"><a href="#npmå¸¸ç”¨å‘½ä»¤" class="headerlink" title="npmå¸¸ç”¨å‘½ä»¤"></a>npmå¸¸ç”¨å‘½ä»¤</h2><h3 id="npm-config"><a href="#npm-config" class="headerlink" title="npm config"></a>npm config</h3><p>ç®¡ç†npm é…ç½®æ–‡ä»¶ï¼Œè¯¥<code>npm config</code>å‘½ä»¤å¯ç”¨äºæ›´æ–°å’Œç¼–è¾‘ç”¨æˆ·å’Œå…¨å±€ <code>npmrc</code> æ–‡ä»¶çš„å†…å®¹ã€‚</p>
<p><code>.nmprc </code> æ–‡ä»¶ä½ç½®ï¼š  <code>$HOME/.npmrc </code> æ¯”å¦‚<code> /Users/duyafei/.npmrc</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm config <span class="built_in">set</span> &lt;key&gt;=&lt;value&gt; [&lt;key&gt;=&lt;value&gt; ...]</span><br><span class="line">npm config get [&lt;key&gt; [&lt;key&gt; ...]]</span><br><span class="line">npm config delete &lt;key&gt; [&lt;key&gt; ...]</span><br><span class="line">npm config list [--json]</span><br><span class="line">npm config edit</span><br><span class="line">npm config fix</span><br><span class="line"></span><br><span class="line"><span class="built_in">alias</span>: c</span><br></pre></td></tr></table></figure>

<ul>
<li>è®¾ç½®é•œåƒä»“åº“&#x20;</li>
</ul>
<pre><code>`npm config set registry `&lt;https://registry.npmmirror.com&gt;
</code></pre>
<ul>
<li>è®¾ç½®å…¨å±€ä»“åº“åœ°å€ &#x20;</li>
</ul>
<pre><code>`npm config set prefix`  ä½ çš„ç›®å½•ï¼› é»˜è®¤ `&#123;prefix&#125;/bin/node` æ¯”å¦‚ `/opt/middleware/nvm/versions/node/v21.7.1`
</code></pre>
<ul>
<li>è®¾ç½®å…¨å±€ç¼“å­˜åœ°å€ &#x20;</li>
</ul>
<pre><code>`npm config set cache`  ä½ çš„ç›®å½• ï¼› é»˜è®¤ `~/.npm`
</code></pre>
<h3 id="npm-install"><a href="#npm-install" class="headerlink" title="npm-install"></a>npm-install</h3><p>å®‰è£…ä¸€ä¸ªåŒ…</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install [&lt;package-spec&gt; ...]</span><br><span class="line"></span><br><span class="line">aliases: add, i, <span class="keyword">in</span>, ins, inst, insta, instal, isnt, isnta, isntal, isntall</span><br></pre></td></tr></table></figure>

<ul>
<li>æœ¬åœ°å®‰è£…</li>
</ul>
<pre><code>`npm install  pnpm`
</code></pre>
<ul>
<li>å…¨å±€å®‰è£…</li>
</ul>
<pre><code>`npm install -g pnpm`
</code></pre>
<h3 id="npm-uninstall"><a href="#npm-uninstall" class="headerlink" title="npm-uninstall"></a>npm-uninstall</h3><p>å¸è½½ åŒ…</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm uninstall [&lt;@scope&gt;/]&lt;pkg&gt;...</span><br><span class="line"></span><br><span class="line">aliases: <span class="built_in">unlink</span>, remove, <span class="built_in">rm</span>, r, un</span><br></pre></td></tr></table></figure>

<ul>
<li>åˆ é™¤ saxï¼Œ åŒæ—¶ ä»<code> package.json</code>ä¸­ç§»é™¤ saxä¾èµ–</li>
</ul>
<pre><code>`npm uninstall sax`  &amp;#x20;
</code></pre>
<ul>
<li>åˆ é™¤ saxï¼Œ <code> package.json</code> ä¸ç§»é™¤saxä¾èµ–</li>
</ul>
<pre><code>`npm uninstall lodash --no-save`
</code></pre>
<h3 id="npm-root"><a href="#npm-root" class="headerlink" title="npm root"></a>npm root</h3><p>æ˜¾ç¤º npm å®‰è£…æ ¹ç›®å½•</p>
<ul>
<li>æ˜¾ç¤ºæœ¬åœ°å®‰è£…çš„ç›®å½•</li>
</ul>
<pre><code>`npm root`   ç»“æœï¼š` /Users/duyafei/node_modules`
</code></pre>
<ul>
<li>æ˜¾ç¤ºå…¨å±€åŒ…å®‰è£…çš„ç›®å½•</li>
</ul>
<pre><code>`npm root -g`  ç»“æœï¼š ` /opt/middleware/nvm/versions/node/v21.7.1/lib/node_modules`
</code></pre>
<h2 id="æŸ¥çœ‹npmé…ç½®"><a href="#æŸ¥çœ‹npmé…ç½®" class="headerlink" title="æŸ¥çœ‹npmé…ç½®"></a>æŸ¥çœ‹npmé…ç½®</h2><h4 id="æŸ¥çœ‹-å½“å‰é…ç½®"><a href="#æŸ¥çœ‹-å½“å‰é…ç½®" class="headerlink" title="æŸ¥çœ‹ å½“å‰é…ç½®"></a>æŸ¥çœ‹ å½“å‰é…ç½®</h4><ul>
<li><code>npm config list</code>   <code>npm config ls</code></li>
</ul>
<pre><code><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">; <span class="string">&quot;user&quot;</span> config from /Users/duyafei/.npmrc</span><br><span class="line"></span><br><span class="line">//repo3.corpautohome.com/repository/npm-group/:_password = (protected)</span><br><span class="line">//repo3.corpautohome.com/repository/npm-group/:username = <span class="string">&quot;npm&quot;</span></span><br><span class="line">registry = <span class="string">&quot;https://registry.npmmirror.com/&quot;</span></span><br><span class="line">strict-ssl = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">; node bin location = /opt/middleware/nvm/versions/node/v21.7.1/bin/node</span><br><span class="line">; node version = v21.7.1</span><br><span class="line">; npm <span class="built_in">local</span> prefix = /Users/duyafei</span><br><span class="line">; npm version = 10.5.0</span><br><span class="line">; cwd = /Users/duyafei</span><br><span class="line">; HOME = /Users/duyafei</span><br><span class="line">; Run `npm config <span class="built_in">ls</span> -l` to show all defaults.</span><br></pre></td></tr></table></figure>
</code></pre>
<h4 id="æŸ¥çœ‹æ‰€æœ‰é»˜è®¤å€¼"><a href="#æŸ¥çœ‹æ‰€æœ‰é»˜è®¤å€¼" class="headerlink" title="æŸ¥çœ‹æ‰€æœ‰é»˜è®¤å€¼"></a>æŸ¥çœ‹æ‰€æœ‰é»˜è®¤å€¼</h4><ul>
<li><code>npm config ls -l</code>  <code>npm config list -l</code>&#x20;</li>
</ul>
<pre><code><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">; <span class="string">&quot;default&quot;</span> config from default values</span><br><span class="line"></span><br><span class="line">_auth = (protected)</span><br><span class="line">access = null</span><br><span class="line">all = <span class="literal">false</span></span><br><span class="line">allow-same-version = <span class="literal">false</span></span><br><span class="line">also = null</span><br><span class="line">audit = <span class="literal">true</span></span><br><span class="line">audit-level = null</span><br><span class="line">auth-type = <span class="string">&quot;web&quot;</span></span><br><span class="line">before = null</span><br><span class="line">bin-links = <span class="literal">true</span></span><br><span class="line">browser = null</span><br><span class="line">ca = null</span><br><span class="line">cache = <span class="string">&quot;/Users/duyafei/.npm&quot;</span></span><br><span class="line">cache-max = null</span><br><span class="line">cache-min = 0</span><br><span class="line">cafile = null</span><br><span class="line">call = <span class="string">&quot;&quot;</span></span><br><span class="line">cert = null</span><br><span class="line">cidr = null</span><br><span class="line">color = <span class="literal">true</span></span><br><span class="line">commit-hooks = <span class="literal">true</span></span><br><span class="line">cpu = null</span><br><span class="line">depth = null</span><br><span class="line">description = <span class="literal">true</span></span><br><span class="line">dev = <span class="literal">false</span></span><br><span class="line">diff = []</span><br><span class="line">diff-dst-prefix = <span class="string">&quot;b/&quot;</span></span><br><span class="line">diff-ignore-all-space = <span class="literal">false</span></span><br><span class="line">diff-name-only = <span class="literal">false</span></span><br><span class="line">diff-no-prefix = <span class="literal">false</span></span><br><span class="line">diff-src-prefix = <span class="string">&quot;a/&quot;</span></span><br><span class="line">diff-text = <span class="literal">false</span></span><br><span class="line">diff-unified = 3</span><br><span class="line">dry-run = <span class="literal">false</span></span><br><span class="line">editor = <span class="string">&quot;vi&quot;</span></span><br><span class="line">engine-strict = <span class="literal">false</span></span><br><span class="line">expect-result-count = null</span><br><span class="line">expect-results = null</span><br><span class="line">fetch-retries = 2</span><br><span class="line">fetch-retry-factor = 10</span><br><span class="line">fetch-retry-maxtimeout = 60000</span><br><span class="line">fetch-retry-mintimeout = 10000</span><br><span class="line">fetch-timeout = 300000</span><br><span class="line">force = <span class="literal">false</span></span><br><span class="line">foreground-scripts = <span class="literal">false</span></span><br><span class="line">format-package-lock = <span class="literal">true</span></span><br><span class="line">fund = <span class="literal">true</span></span><br><span class="line">git = <span class="string">&quot;git&quot;</span></span><br><span class="line">git-tag-version = <span class="literal">true</span></span><br><span class="line">global = <span class="literal">false</span></span><br><span class="line">global-style = <span class="literal">false</span></span><br><span class="line">globalconfig = <span class="string">&quot;/opt/middleware/nvm/versions/node/v21.7.1/etc/npmrc&quot;</span></span><br><span class="line">heading = <span class="string">&quot;npm&quot;</span></span><br><span class="line">https-proxy = null</span><br><span class="line">if-present = <span class="literal">false</span></span><br><span class="line">ignore-scripts = <span class="literal">false</span></span><br><span class="line">include = []</span><br><span class="line">include-staged = <span class="literal">false</span></span><br><span class="line">include-workspace-root = <span class="literal">false</span></span><br><span class="line">init-author-email = <span class="string">&quot;&quot;</span></span><br><span class="line">init-author-name = <span class="string">&quot;&quot;</span></span><br><span class="line">init-author-url = <span class="string">&quot;&quot;</span></span><br><span class="line">init-license = <span class="string">&quot;ISC&quot;</span></span><br><span class="line">init-module = <span class="string">&quot;/Users/duyafei/.npm-init.js&quot;</span></span><br><span class="line">init-version = <span class="string">&quot;1.0.0&quot;</span></span><br><span class="line">init.author.email = <span class="string">&quot;&quot;</span></span><br><span class="line">init.author.name = <span class="string">&quot;&quot;</span></span><br><span class="line">init.author.url = <span class="string">&quot;&quot;</span></span><br><span class="line">init.license = <span class="string">&quot;ISC&quot;</span></span><br><span class="line">init.module = <span class="string">&quot;/Users/duyafei/.npm-init.js&quot;</span></span><br><span class="line">init.version = <span class="string">&quot;1.0.0&quot;</span></span><br><span class="line">install-links = <span class="literal">false</span></span><br><span class="line">install-strategy = <span class="string">&quot;hoisted&quot;</span></span><br><span class="line">json = <span class="literal">false</span></span><br><span class="line">key = null</span><br><span class="line">legacy-bundling = <span class="literal">false</span></span><br><span class="line">legacy-peer-deps = <span class="literal">false</span></span><br><span class="line">libc = null</span><br><span class="line"><span class="built_in">link</span> = <span class="literal">false</span></span><br><span class="line">local-address = null</span><br><span class="line">location = <span class="string">&quot;user&quot;</span></span><br><span class="line">lockfile-version = null</span><br><span class="line">loglevel = <span class="string">&quot;notice&quot;</span></span><br><span class="line">logs-dir = null</span><br><span class="line">logs-max = 10</span><br><span class="line">; long = <span class="literal">false</span> ; overridden by cli</span><br><span class="line">maxsockets = 15</span><br><span class="line">message = <span class="string">&quot;%s&quot;</span></span><br><span class="line">node-options = null</span><br><span class="line">noproxy = [<span class="string">&quot;&quot;</span>]</span><br><span class="line">npm-version = <span class="string">&quot;10.5.0&quot;</span></span><br><span class="line">offline = <span class="literal">false</span></span><br><span class="line">omit = []</span><br><span class="line">omit-lockfile-registry-resolved = <span class="literal">false</span></span><br><span class="line">only = null</span><br><span class="line">optional = null</span><br><span class="line">os = null</span><br><span class="line">otp = null</span><br><span class="line">pack-destination = <span class="string">&quot;.&quot;</span></span><br><span class="line">package = []</span><br><span class="line">package-lock = <span class="literal">true</span></span><br><span class="line">package-lock-only = <span class="literal">false</span></span><br><span class="line">parseable = <span class="literal">false</span></span><br><span class="line">prefer-dedupe = <span class="literal">false</span></span><br><span class="line">prefer-offline = <span class="literal">false</span></span><br><span class="line">prefer-online = <span class="literal">false</span></span><br><span class="line">prefix = <span class="string">&quot;/opt/middleware/nvm/versions/node/v21.7.1&quot;</span></span><br><span class="line">preid = <span class="string">&quot;&quot;</span></span><br><span class="line">production = null</span><br><span class="line">progress = <span class="literal">true</span></span><br><span class="line">provenance = <span class="literal">false</span></span><br><span class="line">provenance-file = null</span><br><span class="line">proxy = null</span><br><span class="line">read-only = <span class="literal">false</span></span><br><span class="line">rebuild-bundle = <span class="literal">true</span></span><br><span class="line">; registry = <span class="string">&quot;https://registry.npmjs.org/&quot;</span> ; overridden by user</span><br><span class="line">replace-registry-host = <span class="string">&quot;npmjs&quot;</span></span><br><span class="line">save = <span class="literal">true</span></span><br><span class="line">save-bundle = <span class="literal">false</span></span><br><span class="line">save-dev = <span class="literal">false</span></span><br><span class="line">save-exact = <span class="literal">false</span></span><br><span class="line">save-optional = <span class="literal">false</span></span><br><span class="line">save-peer = <span class="literal">false</span></span><br><span class="line">save-prefix = <span class="string">&quot;^&quot;</span></span><br><span class="line">save-prod = <span class="literal">false</span></span><br><span class="line">sbom-format = null</span><br><span class="line">sbom-type = <span class="string">&quot;library&quot;</span></span><br><span class="line">scope = <span class="string">&quot;&quot;</span></span><br><span class="line">script-shell = null</span><br><span class="line">searchexclude = <span class="string">&quot;&quot;</span></span><br><span class="line">searchlimit = 20</span><br><span class="line">searchopts = <span class="string">&quot;&quot;</span></span><br><span class="line">searchstaleness = 900</span><br><span class="line">shell = <span class="string">&quot;/bin/zsh&quot;</span></span><br><span class="line">shrinkwrap = <span class="literal">true</span></span><br><span class="line">sign-git-commit = <span class="literal">false</span></span><br><span class="line">sign-git-tag = <span class="literal">false</span></span><br><span class="line">strict-peer-deps = <span class="literal">false</span></span><br><span class="line">; strict-ssl = <span class="literal">true</span> ; overridden by user</span><br><span class="line">tag = <span class="string">&quot;latest&quot;</span></span><br><span class="line">tag-version-prefix = <span class="string">&quot;v&quot;</span></span><br><span class="line">timing = <span class="literal">false</span></span><br><span class="line"><span class="built_in">umask</span> = 0</span><br><span class="line">unicode = <span class="literal">true</span></span><br><span class="line">update-notifier = <span class="literal">true</span></span><br><span class="line">usage = <span class="literal">false</span></span><br><span class="line">user-agent = <span class="string">&quot;npm/&#123;npm-version&#125; node/&#123;node-version&#125; &#123;platform&#125; &#123;arch&#125; workspaces/&#123;workspaces&#125; &#123;ci&#125;&quot;</span></span><br><span class="line">userconfig = <span class="string">&quot;/Users/duyafei/.npmrc&quot;</span></span><br><span class="line">version = <span class="literal">false</span></span><br><span class="line">versions = <span class="literal">false</span></span><br><span class="line">viewer = <span class="string">&quot;man&quot;</span></span><br><span class="line"><span class="built_in">which</span> = null</span><br><span class="line">workspace = []</span><br><span class="line">workspaces = null</span><br><span class="line">workspaces-update = <span class="literal">true</span></span><br><span class="line"><span class="built_in">yes</span> = null</span><br><span class="line"></span><br><span class="line">; <span class="string">&quot;user&quot;</span> config from /Users/duyafei/.npmrc</span><br><span class="line"></span><br><span class="line">//repo3.corpautohome.com/repository/npm-group/:_password = (protected)</span><br><span class="line">//repo3.corpautohome.com/repository/npm-group/:username = <span class="string">&quot;npm&quot;</span></span><br><span class="line">registry = <span class="string">&quot;https://registry.npmmirror.com/&quot;</span></span><br><span class="line">strict-ssl = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">; <span class="string">&quot;cli&quot;</span> config from <span class="built_in">command</span> line options</span><br><span class="line"></span><br><span class="line">long = <span class="literal">true</span></span><br></pre></td></tr></table></figure>
</code></pre>
<hr>
<h2 id="npmç›®å½•ç»“æ„"><a href="#npmç›®å½•ç»“æ„" class="headerlink" title="npmç›®å½•ç»“æ„"></a>npmç›®å½•ç»“æ„</h2><p><a href="https://docs.npmjs.com/cli/v10/configuring-npm/folders" title="https://docs.npmjs.com/cli/v10/configuring-npm/folders">https://docs.npmjs.com/cli/v10/configuring-npm/folders</a></p>
<ul>
<li><code>æœ¬åœ°å®‰è£…</code>ï¼ˆé»˜è®¤ï¼‰ï¼š å®‰è£…åˆ°<code> ./node_modules</code></li>
<li><code>å…¨å±€å®‰è£…</code>ï¼ˆä½¿ç”¨ <code>-g</code>ï¼‰ï¼šå®‰è£…åˆ°  <code>/usr/local</code> æˆ–è€… <code>node</code> çš„å®‰è£…ç›®å½•</li>
<li>å¦‚æœè¦å‘½ä»¤è¡Œé‡Œéšæ—¶å¯ç”¨ï¼Œ ä½¿ç”¨<code>å…¨å±€å®‰è£…</code></li>
</ul>
<h3 id="prefix-é…ç½®"><a href="#prefix-é…ç½®" class="headerlink" title="prefix é…ç½®"></a>prefix é…ç½®</h3><p><code>prefix</code> é»˜è®¤åœ¨<code>node</code>å®‰è£…ç›®å½• ï¼Œ</p>
<ul>
<li>å¤§éƒ¨åˆ†éƒ½åœ¨ <code>/usr/local</code></li>
<li>On Windowsï¼š  itâ€™s <code>%AppData%\npm</code></li>
<li>On Unix systemsï¼š<code>&#123;prefix&#125;/bin/node</code></li>
</ul>
<p>ä½¿ç”¨ <code>npm config -g</code> æŸ¥çœ‹, æ¯”å¦‚æˆ‘çš„<code>nvm</code> ç®¡ç†çš„node <code>/opt/middleware/nvm/versions/node/v21.7.1</code></p>
<h3 id="Node-Modules-å…¨å±€åŒ…çš„å®‰è£…ç›®å½•"><a href="#Node-Modules-å…¨å±€åŒ…çš„å®‰è£…ç›®å½•" class="headerlink" title="Node Modules - å…¨å±€åŒ…çš„å®‰è£…ç›®å½•"></a>Node Modules - å…¨å±€åŒ…çš„å®‰è£…ç›®å½•</h3><p><code>node_modules</code>åŒ…è¢«æ”¾å…¥<code>prefix</code></p>
<ul>
<li>mac ç³»ç»Ÿï¼š<code>&#123;prefix&#125;/lib/node_modules</code>ï¼Œæ¯”å¦‚æˆ‘çš„å®‰è£…åœ¨<code>/opt/middleware/nvm/versions/node/v21.7.1/lib/node_modules</code></li>
<li>windowsç³»ç»Ÿï¼š<code>&#123;prefix&#125;/node_modules</code>ï¼ˆå³æ²¡æœ‰<code>lib</code>æ–‡ä»¶å¤¹ã€‚ï¼‰</li>
</ul>
<h3 id="Executables-å¯æ‰§è¡Œæ–‡ä»¶"><a href="#Executables-å¯æ‰§è¡Œæ–‡ä»¶" class="headerlink" title="Executables-å¯æ‰§è¡Œæ–‡ä»¶"></a>Executables-å¯æ‰§è¡Œæ–‡ä»¶</h3><ul>
<li>å…¨å±€æ¨¡å¼ï¼š å¯æ‰§è¡Œæ–‡ä»¶è¢«é“¾æ¥åˆ°  mac <code>&#123;prefix&#125;/bin</code>ï¼Œ windows ç›´æ¥åœ¨ <code>&#123;prefix&#125;</code>ï¼Œç¡®ä¿è¿™ä¸ªè·¯å¾„åœ¨ä½ çš„<code>path</code> ç¯å¢ƒå˜é‡é‡Œ</li>
<li>æœ¬åœ°æ¨¡å¼ï¼šå¯æ‰§è¡Œæ–‡ä»¶è¢«é“¾æ¥åˆ°<code> ./node_modules/.bin</code></li>
</ul>
<h3 id="Man-Pages-ä¸»é¡µ"><a href="#Man-Pages-ä¸»é¡µ" class="headerlink" title="Man Pages - ä¸»é¡µ"></a>Man Pages - ä¸»é¡µ</h3><p><code>doc</code> å’Œ<code>man</code>çš„ç›®å½•</p>
<p><code>&#123;prefix&#125;/share/man</code> æ¯”å¦‚ï¼š<code>/opt/middleware/nvm/versions/node/v21.7.1/share/man</code></p>
<h3 id="cache-ç¼“å­˜ç›®å½•"><a href="#cache-ç¼“å­˜ç›®å½•" class="headerlink" title="cache - ç¼“å­˜ç›®å½•"></a>cache - ç¼“å­˜ç›®å½•</h3><p>ç¼“å­˜æ–‡ä»¶å­˜å‚¨åœ¨ <code>~/.npm</code> on Posix, æˆ–è€…  <code>%LocalAppData%/npm-cache</code> on Windows</p>
<p><code>npm config get cache</code> æŸ¥çœ‹è‡ªå·±çš„ç¼“å­˜ç›®å½•ï¼Œæ¯”å¦‚ï¼š<code>/Users/duyafei/.npm</code></p>
<h3 id="registry-é•œåƒä»“åº“"><a href="#registry-é•œåƒä»“åº“" class="headerlink" title="registry-é•œåƒä»“åº“"></a>registry-é•œåƒä»“åº“</h3><p><code>npm config get registry</code>  æŸ¥çœ‹ï¼Œ æ¯”å¦‚ï¼š<a href="https://registry.npmmirror.com/">https://registry.npmmirror.com/</a></p>
]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>nodejs</tag>
        <tag>npm</tag>
      </tags>
  </entry>
  <entry>
    <title>æµ‹è¯•é¡µé¢</title>
    <url>/posts/12591/</url>
    <content><![CDATA[<p>æœ‰é“äº‘é“¾æ¥ï¼š<br><a href="http://note.youdao.com/noteshare?id=e8e3fcbeb1428c2da9e0764c796d2660&sub=A81213EC3FB44E408A12B7273BEA0C37">http://note.youdao.com/noteshare?id=e8e3fcbeb1428c2da9e0764c796d2660&amp;sub=A81213EC3FB44E408A12B7273BEA0C37</a></p>
<p>Springæœ€é‡è¦çš„åŠŸèƒ½å°±æ˜¯å¸®åŠ©ç¨‹åºå‘˜åˆ›å»ºå¯¹è±¡ï¼ˆä¹Ÿå°±æ˜¯IOCï¼‰ï¼Œè€Œå¯åŠ¨Springå°±æ˜¯ä¸ºåˆ›å»ºBeanå¯¹è±¡åšå‡†å¤‡ï¼Œæ‰€ä»¥æˆ‘ä»¬å…ˆæ˜ç™½Springåˆ°åº•æ˜¯æ€ä¹ˆå»åˆ›å»ºBeançš„ï¼Œä¹Ÿå°±æ˜¯å…ˆå¼„æ˜ç™½Beançš„ç”Ÿå‘½å‘¨æœŸã€‚</p>
<p>Beançš„ç”Ÿå‘½å‘¨æœŸå°±æ˜¯æŒ‡ï¼š<strong>åœ¨Springä¸­ï¼Œä¸€ä¸ªBeanæ˜¯å¦‚ä½•ç”Ÿæˆçš„ï¼Œå¦‚ä½•é”€æ¯çš„</strong></p>
<p>Beanç”Ÿå‘½å‘¨æœŸæµç¨‹å›¾ï¼š<a href="https://www.processon.com/view/link/5f8588c87d9c0806f27358c1">https://www.processon.com/view/link/5f8588c87d9c0806f27358c1</a></p>
<p>é™„å¸¦èµ„æ–™JFRä»‹ç»ï¼š<a href="https://zhuanlan.zhihu.com/p/122247741">https://zhuanlan.zhihu.com/p/122247741</a></p>
<h2 id="Beançš„ç”Ÿæˆè¿‡ç¨‹"><a href="#Beançš„ç”Ÿæˆè¿‡ç¨‹" class="headerlink" title="Beançš„ç”Ÿæˆè¿‡ç¨‹"></a>Beançš„ç”Ÿæˆè¿‡ç¨‹</h2><h3 id="1-ç”ŸæˆBeanDefinition"><a href="#1-ç”ŸæˆBeanDefinition" class="headerlink" title="1. ç”ŸæˆBeanDefinition"></a>1. ç”ŸæˆBeanDefinition</h3><p>Springå¯åŠ¨çš„æ—¶å€™ä¼šè¿›è¡Œæ‰«æï¼Œä¼šå…ˆè°ƒç”¨org.springframework.context.annotation.ClassPathScanningCandidateComponentProvider#scanCandidateComponents(String basePackage)<br>æ‰«ææŸä¸ªåŒ…è·¯å¾„ï¼Œå¹¶å¾—åˆ°BeanDefinitionçš„Seté›†åˆã€‚</p>
<p><strong>å…³äºSpringå¯åŠ¨æµç¨‹ï¼Œåç»­ä¼šå•ç‹¬çš„è¯¾è¯¦ç»†è®²ï¼Œè¿™é‡Œå…ˆè®²ä¸€ä¸‹Springæ‰«æçš„åº•å±‚å®ç°ï¼š</strong></p>
<p>Springæ‰«æåº•å±‚æµç¨‹ï¼š<a href="https://www.processon.com/view/link/61370ee60e3e7412ecd95d43">https://www.processon.com/view/link/61370ee60e3e7412ecd95d43</a></p>
<ol>
<li>é¦–å…ˆï¼Œé€šè¿‡ResourcePatternResolverè·å¾—æŒ‡å®šåŒ…è·¯å¾„ä¸‹çš„æ‰€æœ‰.classæ–‡ä»¶ï¼ˆSpringæºç ä¸­å°†æ­¤æ–‡ä»¶åŒ…è£…æˆäº†Resourceå¯¹è±¡ï¼‰</li>
<li>éå†æ¯ä¸ªResourceå¯¹è±¡</li>
<li>åˆ©ç”¨MetadataReaderFactoryè§£æResourceå¯¹è±¡å¾—åˆ°MetadataReaderï¼ˆåœ¨Springæºç ä¸­MetadataReaderFactoryå…·ä½“çš„å®ç°ç±»ä¸ºCachingMetadataReaderFactoryï¼ŒMetadataReaderçš„å…·ä½“å®ç°ç±»ä¸ºSimpleMetadataReaderï¼‰</li>
<li>åˆ©ç”¨MetadataReaderè¿›è¡ŒexcludeFilterså’ŒincludeFiltersï¼Œä»¥åŠæ¡ä»¶æ³¨è§£@Conditionalçš„ç­›é€‰ï¼ˆæ¡ä»¶æ³¨è§£å¹¶ä¸èƒ½ç†è§£ï¼šæŸä¸ªç±»ä¸Šæ˜¯å¦å­˜åœ¨@Conditionalæ³¨è§£ï¼Œå¦‚æœå­˜åœ¨åˆ™è°ƒç”¨æ³¨è§£ä¸­æ‰€æŒ‡å®šçš„ç±»çš„matchæ–¹æ³•è¿›è¡ŒåŒ¹é…ï¼ŒåŒ¹é…æˆåŠŸåˆ™é€šè¿‡ç­›é€‰ï¼ŒåŒ¹é…å¤±è´¥åˆ™passæ‰ã€‚ï¼‰</li>
<li>ç­›é€‰é€šè¿‡åï¼ŒåŸºäºmetadataReaderç”ŸæˆScannedGenericBeanDefinition</li>
<li>å†åŸºäºmetadataReaderåˆ¤æ–­æ˜¯ä¸æ˜¯å¯¹åº”çš„ç±»æ˜¯ä¸æ˜¯æ¥å£æˆ–æŠ½è±¡ç±»</li>
<li>å¦‚æœç­›é€‰é€šè¿‡ï¼Œé‚£ä¹ˆå°±è¡¨ç¤ºæ‰«æåˆ°äº†ä¸€ä¸ªBeanï¼Œå°†ScannedGenericBeanDefinitionåŠ å…¥ç»“æœé›†</li>
</ol>
<p>MetadataReaderè¡¨ç¤ºç±»çš„å…ƒæ•°æ®è¯»å–å™¨ï¼Œä¸»è¦åŒ…å«äº†ä¸€ä¸ªAnnotationMetadataï¼ŒåŠŸèƒ½æœ‰</p>
<ol>
<li>è·å–ç±»çš„åå­—ã€</li>
<li>è·å–çˆ¶ç±»çš„åå­—</li>
<li>è·å–æ‰€å®ç°çš„æ‰€æœ‰æ¥å£å</li>
<li>è·å–æ‰€æœ‰å†…éƒ¨ç±»çš„åå­—</li>
<li>åˆ¤æ–­æ˜¯ä¸æ˜¯æŠ½è±¡ç±»</li>
<li>åˆ¤æ–­æ˜¯ä¸æ˜¯æ¥å£</li>
<li>åˆ¤æ–­æ˜¯ä¸æ˜¯ä¸€ä¸ªæ³¨è§£</li>
<li>è·å–æ‹¥æœ‰æŸä¸ªæ³¨è§£çš„æ–¹æ³•é›†åˆ</li>
<li>è·å–ç±»ä¸Šæ·»åŠ çš„æ‰€æœ‰æ³¨è§£ä¿¡æ¯</li>
<li>è·å–ç±»ä¸Šæ·»åŠ çš„æ‰€æœ‰æ³¨è§£ç±»å‹é›†åˆ</li>
</ol>
<p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒCachingMetadataReaderFactoryè§£ææŸä¸ª.classæ–‡ä»¶å¾—åˆ°MetadataReaderå¯¹è±¡æ˜¯åˆ©ç”¨çš„<strong>ASM</strong>æŠ€æœ¯ï¼Œå¹¶æ²¡æœ‰åŠ è½½è¿™ä¸ªç±»åˆ°JVMã€‚å¹¶ä¸”ï¼Œæœ€ç»ˆå¾—åˆ°çš„ScannedGenericBeanDefinitionå¯¹è±¡ï¼Œ<strong>beanClasså±æ€§å­˜å‚¨çš„æ˜¯å½“å‰ç±»çš„åå­—ï¼Œè€Œä¸æ˜¯classå¯¹è±¡</strong>ã€‚ï¼ˆbeanClasså±æ€§çš„ç±»å‹æ˜¯Objectï¼Œå®ƒå³å¯ä»¥å­˜å‚¨ç±»çš„åå­—ï¼Œä¹Ÿå¯ä»¥å­˜å‚¨classå¯¹è±¡ï¼‰</p>
<p>æœ€åï¼Œä¸Šé¢æ˜¯è¯´çš„é€šè¿‡æ‰«æå¾—åˆ°BeanDefinitionå¯¹è±¡ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡ç›´æ¥å®šä¹‰BeanDefinitionï¼Œæˆ–è§£æspring.xmlæ–‡ä»¶çš„<bean/>ï¼Œæˆ–è€…@Beanæ³¨è§£å¾—åˆ°BeanDefinitionå¯¹è±¡ã€‚ï¼ˆåç»­è¯¾ç¨‹ä¼šåˆ†æ@Beanæ³¨è§£æ˜¯æ€ä¹ˆç”ŸæˆBeanDefinitionçš„ï¼‰ã€‚</p>
<h3 id="2-åˆå¹¶BeanDefinition"><a href="#2-åˆå¹¶BeanDefinition" class="headerlink" title="2. åˆå¹¶BeanDefinition"></a>2. åˆå¹¶BeanDefinition</h3><p>é€šè¿‡æ‰«æå¾—åˆ°æ‰€æœ‰BeanDefinitionä¹‹åï¼Œå°±å¯ä»¥æ ¹æ®BeanDefinitionåˆ›å»ºBeanå¯¹è±¡äº†ï¼Œä½†æ˜¯åœ¨Springä¸­æ”¯æŒçˆ¶å­BeanDefinitionï¼Œå’ŒJavaçˆ¶å­ç±»ç±»ä¼¼ï¼Œä½†æ˜¯å®Œå…¨ä¸æ˜¯ä¸€å›äº‹ã€‚</p>
<p>çˆ¶å­BeanDefinitionå®é™…ç”¨çš„æ¯”è¾ƒå°‘ï¼Œä½¿ç”¨æ˜¯è¿™æ ·çš„ï¼Œæ¯”å¦‚ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">&lt;bean id=<span class="string">&quot;parent&quot;</span> class=<span class="string">&quot;com.zhouyu.service.Parent&quot;</span> scope=<span class="string">&quot;prototype&quot;</span>/&gt;</span><br><span class="line">&lt;bean id=<span class="string">&quot;child&quot;</span> class=<span class="string">&quot;com.zhouyu.service.Child&quot;</span>/&gt;</span><br></pre></td></tr></table></figure>

<p>è¿™ä¹ˆå®šä¹‰çš„æƒ…å†µä¸‹ï¼Œchildæ˜¯å•ä¾‹Beanã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">&lt;bean id=<span class="string">&quot;parent&quot;</span> class=<span class="string">&quot;com.zhouyu.service.Parent&quot;</span> scope=<span class="string">&quot;prototype&quot;</span>/&gt;</span><br><span class="line">&lt;bean id=<span class="string">&quot;child&quot;</span> class=<span class="string">&quot;com.zhouyu.service.Child&quot;</span> parent=<span class="string">&quot;parent&quot;</span>/&gt;</span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯è¿™ä¹ˆå®šä¹‰çš„æƒ…å†µä¸‹ï¼Œchildå°±æ˜¯åŸå‹Beanäº†ã€‚</p>
<p>å› ä¸ºchildçš„çˆ¶BeanDefinitionæ˜¯parentï¼Œæ‰€ä»¥ä¼šç»§æ‰¿parentä¸Šæ‰€å®šä¹‰çš„scopeå±æ€§ã€‚</p>
<p>è€Œåœ¨æ ¹æ®childæ¥ç”ŸæˆBeanå¯¹è±¡ä¹‹å‰ï¼Œéœ€è¦è¿›è¡ŒBeanDefinitionçš„åˆå¹¶ï¼Œå¾—åˆ°å®Œæ•´çš„childçš„BeanDefinitionã€‚</p>
<h3 id="3-åŠ è½½ç±»"><a href="#3-åŠ è½½ç±»" class="headerlink" title="3. åŠ è½½ç±»"></a>3. åŠ è½½ç±»</h3><p>BeanDefinitionåˆå¹¶ä¹‹åï¼Œå°±å¯ä»¥å»åˆ›å»ºBeanå¯¹è±¡äº†ï¼Œè€Œåˆ›å»ºBeanå°±å¿…é¡»å®ä¾‹åŒ–å¯¹è±¡ï¼Œè€Œå®ä¾‹åŒ–å°±å¿…é¡»å…ˆåŠ è½½å½“å‰BeanDefinitionæ‰€å¯¹åº”çš„classï¼Œåœ¨AbstractAutowireCapableBeanFactoryç±»çš„createBean()æ–¹æ³•ä¸­ï¼Œä¸€å¼€å§‹å°±ä¼šè°ƒç”¨ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Class&lt;?&gt; resolvedClass = resolveBeanClass(mbd, beanName);</span><br></pre></td></tr></table></figure>

<p>è¿™è¡Œä»£ç å°±æ˜¯å»åŠ è½½ç±»ï¼Œè¯¥æ–¹æ³•æ˜¯è¿™ä¹ˆå®ç°çš„ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (mbd.hasBeanClass()) &#123;</span><br><span class="line"> <span class="keyword">return</span> mbd.getBeanClass();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (System.getSecurityManager() != <span class="literal">null</span>) &#123;</span><br><span class="line"> <span class="keyword">return</span> AccessController.doPrivileged((PrivilegedExceptionAction&lt;Class&lt;?&gt;&gt;) () -&gt;</span><br><span class="line">  doResolveBeanClass(mbd, typesToMatch), getAccessControlContext());</span><br><span class="line"> &#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line"> <span class="keyword">return</span> doResolveBeanClass(mbd, typesToMatch);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">hasBeanClass</span><span class="params">()</span> &#123;</span><br><span class="line"> <span class="keyword">return</span> (<span class="built_in">this</span>.beanClass <span class="keyword">instanceof</span> Class);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœbeanClasså±æ€§çš„ç±»å‹æ˜¯Classï¼Œé‚£ä¹ˆå°±ç›´æ¥è¿”å›ï¼Œå¦‚æœä¸æ˜¯ï¼Œåˆ™ä¼šæ ¹æ®ç±»åè¿›è¡ŒåŠ è½½ï¼ˆdoResolveBeanClassæ–¹æ³•æ‰€åšçš„äº‹æƒ…ï¼‰</p>
<p>ä¼šåˆ©ç”¨BeanFactoryæ‰€è®¾ç½®çš„ç±»åŠ è½½å™¨æ¥åŠ è½½ç±»ï¼Œå¦‚æœæ²¡æœ‰è®¾ç½®ï¼Œåˆ™é»˜è®¤ä½¿ç”¨**ClassUtils.getDefaultClassLoader()**æ‰€è¿”å›çš„ç±»åŠ è½½å™¨æ¥åŠ è½½ã€‚</p>
<h4 id="ClassUtils-getDefaultClassLoader"><a href="#ClassUtils-getDefaultClassLoader" class="headerlink" title="ClassUtils.getDefaultClassLoader()"></a><strong>ClassUtils.getDefaultClassLoader()</strong></h4><ol>
<li>ä¼˜å…ˆè¿”å›å½“å‰çº¿ç¨‹ä¸­çš„ClassLoader</li>
<li>çº¿ç¨‹ä¸­ç±»åŠ è½½å™¨ä¸ºnullçš„æƒ…å†µä¸‹ï¼Œè¿”å›ClassUtilsç±»çš„ç±»åŠ è½½å™¨</li>
<li>å¦‚æœClassUtilsç±»çš„ç±»åŠ è½½å™¨ä¸ºç©ºï¼Œé‚£ä¹ˆåˆ™è¡¨ç¤ºæ˜¯Bootstrapç±»åŠ è½½å™¨åŠ è½½çš„ClassUtilsç±»ï¼Œé‚£ä¹ˆåˆ™è¿”å›ç³»ç»Ÿç±»åŠ è½½å™¨</li>
</ol>
<h3 id="4-å®ä¾‹åŒ–å‰"><a href="#4-å®ä¾‹åŒ–å‰" class="headerlink" title="4. å®ä¾‹åŒ–å‰"></a>4. å®ä¾‹åŒ–å‰</h3><p>å½“å‰BeanDefinitionå¯¹åº”çš„ç±»æˆåŠŸåŠ è½½åï¼Œå°±å¯ä»¥å®ä¾‹åŒ–å¯¹è±¡äº†ï¼Œä½†æ˜¯â€¦</p>
<p>åœ¨Springä¸­ï¼Œå®ä¾‹åŒ–å¯¹è±¡ä¹‹å‰ï¼ŒSpringæä¾›äº†ä¸€ä¸ªæ‰©å±•ç‚¹ï¼Œå…è®¸ç”¨æˆ·æ¥æ§åˆ¶æ˜¯å¦åœ¨æŸä¸ªæˆ–æŸäº›Beanå®ä¾‹åŒ–ä¹‹å‰åšä¸€äº›å¯åŠ¨åŠ¨ä½œã€‚è¿™ä¸ªæ‰©å±•ç‚¹å«**InstantiationAwareBeanPostProcessor.postProcessBeforeInstantiation()**ã€‚æ¯”å¦‚ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ZhouyuBeanPostProcessor</span> <span class="keyword">implements</span> <span class="title class_">InstantiationAwareBeanPostProcessor</span> &#123;</span><br><span class="line"></span><br><span class="line"> <span class="meta">@Override</span></span><br><span class="line"> <span class="keyword">public</span> Object <span class="title function_">postProcessBeforeInstantiation</span><span class="params">(Class&lt;?&gt; beanClass, String beanName)</span> <span class="keyword">throws</span> BeansException &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="string">&quot;userService&quot;</span>.equals(beanName)) &#123;</span><br><span class="line">   System.out.println(<span class="string">&quot;å®ä¾‹åŒ–å‰&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¦‚ä¸Šä»£ç ä¼šå¯¼è‡´ï¼Œåœ¨userServiceè¿™ä¸ªBeanå®ä¾‹åŒ–å‰ï¼Œä¼šè¿›è¡Œæ‰“å°ã€‚</p>
<p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒpostProcessBeforeInstantiation()æ˜¯æœ‰è¿”å›å€¼çš„ï¼Œå¦‚æœè¿™ä¹ˆå®ç°ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ZhouyuBeanPostProcessor</span> <span class="keyword">implements</span> <span class="title class_">InstantiationAwareBeanPostProcessor</span> &#123;</span><br><span class="line"></span><br><span class="line"> <span class="meta">@Override</span></span><br><span class="line"> <span class="keyword">public</span> Object <span class="title function_">postProcessBeforeInstantiation</span><span class="params">(Class&lt;?&gt; beanClass, String beanName)</span> <span class="keyword">throws</span> BeansException &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="string">&quot;userService&quot;</span>.equals(beanName)) &#123;</span><br><span class="line">   System.out.println(<span class="string">&quot;å®ä¾‹åŒ–å‰&quot;</span>);</span><br><span class="line">   <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">UserService</span>();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>userServiceè¿™ä¸ªBeanï¼Œåœ¨å®ä¾‹åŒ–å‰ä¼šç›´æ¥è¿”å›ä¸€ä¸ªç”±æˆ‘ä»¬æ‰€å®šä¹‰çš„UserServiceå¯¹è±¡ã€‚å¦‚æœæ˜¯è¿™æ ·ï¼Œè¡¨ç¤ºä¸éœ€è¦Springæ¥å®ä¾‹åŒ–äº†ï¼Œå¹¶ä¸”åç»­çš„Springä¾èµ–æ³¨å…¥ä¹Ÿä¸ä¼šè¿›è¡Œäº†ï¼Œä¼šè·³è¿‡ä¸€äº›æ­¥éª¤ï¼Œç›´æ¥æ‰§è¡Œåˆå§‹åŒ–åè¿™ä¸€æ­¥ã€‚</p>
<h3 id="5-å®ä¾‹åŒ–"><a href="#5-å®ä¾‹åŒ–" class="headerlink" title="5. å®ä¾‹åŒ–"></a>5. å®ä¾‹åŒ–</h3><p>åœ¨è¿™ä¸ªæ­¥éª¤ä¸­å°±ä¼šæ ¹æ®BeanDefinitionå»åˆ›å»ºä¸€ä¸ªå¯¹è±¡äº†ã€‚</p>
<h3 id="5-1-Supplieråˆ›å»ºå¯¹è±¡"><a href="#5-1-Supplieråˆ›å»ºå¯¹è±¡" class="headerlink" title="5.1 Supplieråˆ›å»ºå¯¹è±¡"></a>5.1 Supplieråˆ›å»ºå¯¹è±¡</h3><p>é¦–å…ˆåˆ¤æ–­BeanDefinitionä¸­æ˜¯å¦è®¾ç½®äº†Supplierï¼Œå¦‚æœè®¾ç½®äº†åˆ™è°ƒç”¨Supplierçš„get()å¾—åˆ°å¯¹è±¡ã€‚</p>
<p>å¾—ç›´æ¥ä½¿ç”¨BeanDefinitionå¯¹è±¡æ¥è®¾ç½®Supplierï¼Œæ¯”å¦‚ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">AbstractBeanDefinition</span> <span class="variable">beanDefinition</span> <span class="operator">=</span> BeanDefinitionBuilder.genericBeanDefinition().getBeanDefinition();</span><br><span class="line">beanDefinition.setInstanceSupplier(<span class="keyword">new</span> <span class="title class_">Supplier</span>&lt;Object&gt;() &#123;</span><br><span class="line"> <span class="meta">@Override</span></span><br><span class="line"> <span class="keyword">public</span> Object <span class="title function_">get</span><span class="params">()</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">UserService</span>();</span><br><span class="line"> &#125;</span><br><span class="line">&#125;);</span><br><span class="line">context.registerBeanDefinition(<span class="string">&quot;userService&quot;</span>, beanDefinition);</span><br></pre></td></tr></table></figure>

<h3 id="5-2-å·¥å‚æ–¹æ³•åˆ›å»ºå¯¹è±¡"><a href="#5-2-å·¥å‚æ–¹æ³•åˆ›å»ºå¯¹è±¡" class="headerlink" title="5.2 å·¥å‚æ–¹æ³•åˆ›å»ºå¯¹è±¡"></a>5.2 å·¥å‚æ–¹æ³•åˆ›å»ºå¯¹è±¡</h3><p>å¦‚æœæ²¡æœ‰è®¾ç½®Supplierï¼Œåˆ™æ£€æŸ¥BeanDefinitionä¸­æ˜¯å¦è®¾ç½®äº†factoryMethodï¼Œä¹Ÿå°±æ˜¯å·¥å‚æ–¹æ³•ï¼Œæœ‰ä¸¤ç§æ–¹å¼å¯ä»¥è®¾ç½®factoryMethodï¼Œæ¯”å¦‚ï¼š</p>
<p>æ–¹å¼ä¸€ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">&lt;bean id=<span class="string">&quot;userService&quot;</span> class=<span class="string">&quot;com.zhouyu.service.UserService&quot;</span> factory-method=<span class="string">&quot;createUserService&quot;</span> /&gt;</span><br></pre></td></tr></table></figure>

<p>å¯¹åº”çš„UserServiceç±»ä¸ºï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">static</span> UserService <span class="title function_">createUserService</span><span class="params">()</span> &#123;</span><br><span class="line">  System.out.println(<span class="string">&quot;æ‰§è¡ŒcreateUserService()&quot;</span>);</span><br><span class="line">  <span class="type">UserService</span> <span class="variable">userService</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UserService</span>();</span><br><span class="line">  <span class="keyword">return</span> userService;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span> &#123;</span><br><span class="line">  System.out.println(<span class="string">&quot;test&quot;</span>);</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ–¹å¼äºŒï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">&lt;bean id=<span class="string">&quot;commonService&quot;</span> class=<span class="string">&quot;com.zhouyu.service.CommonService&quot;</span>/&gt;</span><br><span class="line">&lt;bean id=<span class="string">&quot;userService1&quot;</span> factory-bean=<span class="string">&quot;commonService&quot;</span> factory-method=<span class="string">&quot;createUserService&quot;</span> /&gt;</span><br></pre></td></tr></table></figure>

<p>å¯¹åº”çš„CommonServiceçš„ç±»ä¸ºï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CommonService</span> &#123;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">public</span> UserService <span class="title function_">createUserService</span><span class="params">()</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">UserService</span>();</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Springå‘ç°å½“å‰BeanDefinitionæ–¹æ³•è®¾ç½®äº†å·¥å‚æ–¹æ³•åï¼Œå°±ä¼šåŒºåˆ†è¿™ä¸¤ç§æ–¹å¼ï¼Œç„¶åè°ƒç”¨å·¥å‚æ–¹æ³•å¾—åˆ°å¯¹è±¡ã€‚</p>
<p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬é€šè¿‡@Beanæ‰€å®šä¹‰çš„BeanDefinitionï¼Œæ˜¯å­˜åœ¨factoryMethodå’ŒfactoryBeançš„ï¼Œä¹Ÿå°±æ˜¯å’Œä¸Šé¢çš„æ–¹å¼äºŒéå¸¸ç±»ä¼¼ï¼Œ@Beanæ‰€æ³¨è§£çš„æ–¹æ³•å°±æ˜¯factoryMethodï¼ŒAppConfigå¯¹è±¡å°±æ˜¯factoryBeanã€‚å¦‚æœ@Beanæ‰€æ‰€æ³¨è§£çš„æ–¹æ³•æ˜¯staticçš„ï¼Œé‚£ä¹ˆå¯¹åº”çš„å°±æ˜¯æ–¹å¼ä¸€ã€‚</p>
<h3 id="5-3-æ¨æ–­æ„é€ æ–¹æ³•"><a href="#5-3-æ¨æ–­æ„é€ æ–¹æ³•" class="headerlink" title="5.3 æ¨æ–­æ„é€ æ–¹æ³•"></a>5.3 æ¨æ–­æ„é€ æ–¹æ³•</h3><p>ç¬¬ä¸€èŠ‚å·²ç»è®²è¿‡ä¸€éå¤§æ¦‚åŸç†äº†ï¼Œåé¢æœ‰ä¸€èŠ‚è¯¾å•ç‹¬åˆ†ææºç å®ç°ã€‚æ¨æ–­å®Œæ„é€ æ–¹æ³•åï¼Œå°±ä¼šä½¿ç”¨æ„é€ æ–¹æ³•æ¥è¿›è¡Œå®ä¾‹åŒ–äº†ã€‚</p>
<p>é¢å¤–çš„ï¼Œåœ¨æ¨æ–­æ„é€ æ–¹æ³•é€»è¾‘ä¸­é™¤å¼€ä¼šå»é€‰æ‹©æ„é€ æ–¹æ³•ä»¥åŠæŸ¥æ‰¾å…¥å‚å¯¹è±¡æ„å¤–ï¼Œä¼šè¿˜åˆ¤æ–­æ˜¯å¦åœ¨å¯¹åº”çš„ç±»ä¸­æ˜¯å¦å­˜åœ¨ä½¿ç”¨**@Lookupæ³¨è§£**äº†æ–¹æ³•ã€‚å¦‚æœå­˜åœ¨åˆ™æŠŠè¯¥æ–¹æ³•å°è£…ä¸ºLookupOverrideå¯¹è±¡å¹¶æ·»åŠ åˆ°BeanDefinitionä¸­ã€‚</p>
<p>åœ¨å®ä¾‹åŒ–æ—¶ï¼Œå¦‚æœåˆ¤æ–­å‡ºæ¥å½“å‰BeanDefinitionä¸­æ²¡æœ‰LookupOverrideï¼Œé‚£å°±ç›´æ¥ç”¨æ„é€ æ–¹æ³•åå°„å¾—åˆ°ä¸€ä¸ªå®ä¾‹å¯¹è±¡ã€‚å¦‚æœå­˜åœ¨LookupOverrideå¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯ç±»ä¸­å­˜åœ¨@Lookupæ³¨è§£äº†çš„æ–¹æ³•ï¼Œé‚£å°±ä¼šç”Ÿæˆä¸€ä¸ªä»£ç†å¯¹è±¡ã€‚</p>
<p>@Lookupæ³¨è§£å°±æ˜¯<strong>æ–¹æ³•æ³¨å…¥</strong>ï¼Œä½¿ç”¨demoå¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">private</span> OrderService orderService;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span> &#123;</span><br><span class="line">  <span class="type">OrderService</span> <span class="variable">orderService</span> <span class="operator">=</span> createOrderService();</span><br><span class="line">  System.out.println(orderService);</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> <span class="meta">@Lookup(&quot;orderService&quot;)</span></span><br><span class="line"> <span class="keyword">public</span> OrderService <span class="title function_">createOrderService</span><span class="params">()</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="6-BeanDefinitionçš„åç½®å¤„ç†"><a href="#6-BeanDefinitionçš„åç½®å¤„ç†" class="headerlink" title="6. BeanDefinitionçš„åç½®å¤„ç†"></a>6. BeanDefinitionçš„åç½®å¤„ç†</h3><p>Beanå¯¹è±¡å®ä¾‹åŒ–å‡ºæ¥ä¹‹åï¼Œæ¥ä¸‹æ¥å°±åº”è¯¥ç»™å¯¹è±¡çš„å±æ€§èµ‹å€¼äº†ã€‚åœ¨çœŸæ­£ç»™å±æ€§èµ‹å€¼ä¹‹å‰ï¼ŒSpringåˆæä¾›äº†ä¸€ä¸ªæ‰©å±•ç‚¹**MergedBeanDefinitionPostProcessor.postProcessMergedBeanDefinition()**ï¼Œå¯ä»¥å¯¹æ­¤æ—¶çš„BeanDefinitionè¿›è¡ŒåŠ å·¥ï¼Œæ¯”å¦‚ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ZhouyuMergedBeanDefinitionPostProcessor</span> <span class="keyword">implements</span> <span class="title class_">MergedBeanDefinitionPostProcessor</span> &#123;</span><br><span class="line"></span><br><span class="line"> <span class="meta">@Override</span></span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">postProcessMergedBeanDefinition</span><span class="params">(RootBeanDefinition beanDefinition, Class&lt;?&gt; beanType, String beanName)</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="string">&quot;userService&quot;</span>.equals(beanName)) &#123;</span><br><span class="line">   beanDefinition.getPropertyValues().add(<span class="string">&quot;orderService&quot;</span>, <span class="keyword">new</span> <span class="title class_">OrderService</span>());</span><br><span class="line">  &#125;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨Springæºç ä¸­ï¼ŒAutowiredAnnotationBeanPostProcessorå°±æ˜¯ä¸€ä¸ªMergedBeanDefinitionPostProcessorï¼Œå®ƒçš„postProcessMergedBeanDefinition()ä¸­ä¼šå»æŸ¥æ‰¾æ³¨å…¥ç‚¹ï¼Œå¹¶ç¼“å­˜åœ¨AutowiredAnnotationBeanPostProcessorå¯¹è±¡çš„ä¸€ä¸ªMapä¸­ï¼ˆinjectionMetadataCacheï¼‰ã€‚</p>
<h3 id="7-å®ä¾‹åŒ–å"><a href="#7-å®ä¾‹åŒ–å" class="headerlink" title="7. å®ä¾‹åŒ–å"></a>7. å®ä¾‹åŒ–å</h3><p>åœ¨å¤„ç†å®ŒBeanDefinitionåï¼ŒSpringåˆè®¾è®¡äº†ä¸€ä¸ªæ‰©å±•ç‚¹ï¼š**InstantiationAwareBeanPostProcessor.postProcessAfterInstantiation()**ï¼Œæ¯”å¦‚ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ZhouyuInstantiationAwareBeanPostProcessor</span> <span class="keyword">implements</span> <span class="title class_">InstantiationAwareBeanPostProcessor</span> &#123;</span><br><span class="line"></span><br><span class="line"> <span class="meta">@Override</span></span><br><span class="line"> <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">postProcessAfterInstantiation</span><span class="params">(Object bean, String beanName)</span> <span class="keyword">throws</span> BeansException &#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (<span class="string">&quot;userService&quot;</span>.equals(beanName)) &#123;</span><br><span class="line">   <span class="type">UserService</span> <span class="variable">userService</span> <span class="operator">=</span> (UserService) bean;</span><br><span class="line">   userService.test();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸Šè¿°ä»£ç å°±æ˜¯å¯¹userServiceæ‰€å®ä¾‹åŒ–å‡ºæ¥çš„å¯¹è±¡è¿›è¡Œå¤„ç†ã€‚</p>
<p>è¿™ä¸ªæ‰©å±•ç‚¹ï¼Œåœ¨Springæºç ä¸­åŸºæœ¬æ²¡æœ‰æ€ä¹ˆä½¿ç”¨ã€‚</p>
<h3 id="8-è‡ªåŠ¨æ³¨å…¥"><a href="#8-è‡ªåŠ¨æ³¨å…¥" class="headerlink" title="8. è‡ªåŠ¨æ³¨å…¥"></a>8. è‡ªåŠ¨æ³¨å…¥</h3><p>è¿™é‡Œçš„è‡ªåŠ¨æ³¨å…¥æŒ‡çš„æ˜¯Springçš„è‡ªåŠ¨æ³¨å…¥ï¼Œåç»­ä¾èµ–æ³¨å…¥è¯¾ç¨‹ä¸­å•ç‹¬è®²</p>
<h3 id="9-å¤„ç†å±æ€§"><a href="#9-å¤„ç†å±æ€§" class="headerlink" title="9. å¤„ç†å±æ€§"></a>9. å¤„ç†å±æ€§</h3><p>è¿™ä¸ªæ­¥éª¤ä¸­ï¼Œå°±ä¼šå¤„ç†@Autowiredã€@Resourceã€@Valueç­‰æ³¨è§£ï¼Œä¹Ÿæ˜¯é€šè¿‡**InstantiationAwareBeanPostProcessor.postProcessProperties()**æ‰©å±•ç‚¹æ¥å®ç°çš„ï¼Œæ¯”å¦‚æˆ‘ä»¬ç”šè‡³å¯ä»¥å®ç°ä¸€ä¸ªè‡ªå·±çš„è‡ªåŠ¨æ³¨å…¥åŠŸèƒ½ï¼Œæ¯”å¦‚ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ZhouyuInstantiationAwareBeanPostProcessor</span> <span class="keyword">implements</span> <span class="title class_">InstantiationAwareBeanPostProcessor</span> &#123;</span><br><span class="line"></span><br><span class="line"> <span class="meta">@Override</span></span><br><span class="line"> <span class="keyword">public</span> PropertyValues <span class="title function_">postProcessProperties</span><span class="params">(PropertyValues pvs, Object bean, String beanName)</span> <span class="keyword">throws</span> BeansException &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="string">&quot;userService&quot;</span>.equals(beanName)) &#123;</span><br><span class="line">   <span class="keyword">for</span> (Field field : bean.getClass().getFields()) &#123;</span><br><span class="line">    <span class="keyword">if</span> (field.isAnnotationPresent(ZhouyuInject.class)) &#123;</span><br><span class="line">     field.setAccessible(<span class="literal">true</span>);</span><br><span class="line">     <span class="keyword">try</span> &#123;</span><br><span class="line">      field.set(bean, <span class="string">&quot;123&quot;</span>);</span><br><span class="line">     &#125; <span class="keyword">catch</span> (IllegalAccessException e) &#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">     &#125;</span><br><span class="line">    &#125;</span><br><span class="line">   &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> pvs;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å…³äº@Autowiredã€@Resourceã€@Valueçš„åº•å±‚æºç ï¼Œä¼šåœ¨åç»­çš„ä¾èµ–æ³¨å…¥è¯¾ç¨‹ä¸­è¯¦è§£ã€‚</p>
<h3 id="10-æ‰§è¡ŒAware"><a href="#10-æ‰§è¡ŒAware" class="headerlink" title="10. æ‰§è¡ŒAware"></a>10. æ‰§è¡ŒAware</h3><p>å®Œæˆäº†å±æ€§èµ‹å€¼ä¹‹åï¼ŒSpringä¼šæ‰§è¡Œä¸€äº›å›è°ƒï¼ŒåŒ…æ‹¬ï¼š</p>
<ol>
<li>BeanNameAwareï¼šå›ä¼ beanNameç»™beanå¯¹è±¡ã€‚</li>
<li>BeanClassLoaderAwareï¼šå›ä¼ classLoaderç»™beanå¯¹è±¡ã€‚</li>
<li>BeanFactoryAwareï¼šå›ä¼ beanFactoryç»™å¯¹è±¡ã€‚</li>
</ol>
<h3 id="11-åˆå§‹åŒ–å‰"><a href="#11-åˆå§‹åŒ–å‰" class="headerlink" title="11. åˆå§‹åŒ–å‰"></a>11. åˆå§‹åŒ–å‰</h3><p>åˆå§‹åŒ–å‰ï¼Œä¹Ÿæ˜¯Springæä¾›çš„ä¸€ä¸ªæ‰©å±•ç‚¹ï¼š**BeanPostProcessor.postProcessBeforeInitialization()**ï¼Œæ¯”å¦‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ZhouyuBeanPostProcessor</span> <span class="keyword">implements</span> <span class="title class_">BeanPostProcessor</span> &#123;</span><br><span class="line"></span><br><span class="line"> <span class="meta">@Override</span></span><br><span class="line"> <span class="keyword">public</span> Object <span class="title function_">postProcessBeforeInitialization</span><span class="params">(Object bean, String beanName)</span> <span class="keyword">throws</span> BeansException &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="string">&quot;userService&quot;</span>.equals(beanName)) &#123;</span><br><span class="line">   System.out.println(<span class="string">&quot;åˆå§‹åŒ–å‰&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> bean;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åˆ©ç”¨åˆå§‹åŒ–å‰ï¼Œå¯ä»¥å¯¹è¿›è¡Œäº†ä¾èµ–æ³¨å…¥çš„Beanè¿›è¡Œå¤„ç†ã€‚</p>
<p>åœ¨Springæºç ä¸­ï¼š</p>
<ol>
<li><p>InitDestroyAnnotationBeanPostProcessorä¼šåœ¨åˆå§‹åŒ–å‰è¿™ä¸ªæ­¥éª¤ä¸­æ‰§è¡Œ@PostConstructçš„æ–¹æ³•ï¼Œ</p>
</li>
<li><p>ApplicationContextAwareProcessorä¼šåœ¨åˆå§‹åŒ–å‰è¿™ä¸ªæ­¥éª¤ä¸­è¿›è¡Œå…¶ä»–Awareçš„å›è°ƒï¼š</p>
</li>
<li><p>EnvironmentAwareï¼šå›ä¼ ç¯å¢ƒå˜é‡</p>
</li>
<li><p>EmbeddedValueResolverAwareï¼šå›ä¼ å ä½ç¬¦è§£æå™¨</p>
</li>
<li><p>ResourceLoaderAwareï¼šå›ä¼ èµ„æºåŠ è½½å™¨</p>
</li>
<li><p>ApplicationEventPublisherAwareï¼šå›ä¼ äº‹ä»¶å‘å¸ƒå™¨</p>
</li>
<li><p>MessageSourceAwareï¼šå›ä¼ å›½é™…åŒ–èµ„æº</p>
</li>
<li><p>ApplicationStartupAwareï¼šå›ä¼ åº”ç”¨å…¶ä»–ç›‘å¬å¯¹è±¡ï¼Œå¯å¿½ç•¥</p>
</li>
<li><p>ApplicationContextAwareï¼šå›ä¼ Springå®¹å™¨ApplicationContext</p>
</li>
</ol>
<h3 id="12-åˆå§‹åŒ–"><a href="#12-åˆå§‹åŒ–" class="headerlink" title="12. åˆå§‹åŒ–"></a>12. åˆå§‹åŒ–</h3><ol>
<li>æŸ¥çœ‹å½“å‰Beanå¯¹è±¡æ˜¯å¦å®ç°äº†InitializingBeanæ¥å£ï¼Œå¦‚æœå®ç°äº†å°±è°ƒç”¨å…¶afterPropertiesSet()æ–¹æ³•</li>
<li>æ‰§è¡ŒBeanDefinitionä¸­æŒ‡å®šçš„åˆå§‹åŒ–æ–¹æ³•</li>
</ol>
<h3 id="13-åˆå§‹åŒ–å"><a href="#13-åˆå§‹åŒ–å" class="headerlink" title="13. åˆå§‹åŒ–å"></a>13. åˆå§‹åŒ–å</h3><p>è¿™æ˜¯Beanåˆ›å»ºç”Ÿå‘½å‘¨æœŸä¸­çš„æœ€åä¸€ä¸ªæ­¥éª¤ï¼Œä¹Ÿæ˜¯Springæä¾›çš„ä¸€ä¸ªæ‰©å±•ç‚¹ï¼š**BeanPostProcessor.postProcessAfterInitialization()**ï¼Œæ¯”å¦‚ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ZhouyuBeanPostProcessor</span> <span class="keyword">implements</span> <span class="title class_">BeanPostProcessor</span> &#123;</span><br><span class="line"></span><br><span class="line"> <span class="meta">@Override</span></span><br><span class="line"> <span class="keyword">public</span> Object <span class="title function_">postProcessAfterInitialization</span><span class="params">(Object bean, String beanName)</span> <span class="keyword">throws</span> BeansException &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="string">&quot;userService&quot;</span>.equals(beanName)) &#123;</span><br><span class="line">   System.out.println(<span class="string">&quot;åˆå§‹åŒ–å&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> bean;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥åœ¨è¿™ä¸ªæ­¥éª¤ä¸­ï¼Œå¯¹Beanæœ€ç»ˆè¿›è¡Œå¤„ç†ï¼ŒSpringä¸­çš„<strong>AOPå°±æ˜¯åŸºäºåˆå§‹åŒ–åå®ç°</strong>çš„ï¼Œ<strong>åˆå§‹åŒ–åè¿”å›çš„å¯¹è±¡æ‰æ˜¯æœ€ç»ˆçš„Beanå¯¹è±¡</strong>ã€‚</p>
<h3 id="æ€»ç»“BeanPostProcessor"><a href="#æ€»ç»“BeanPostProcessor" class="headerlink" title="æ€»ç»“BeanPostProcessor"></a>æ€»ç»“BeanPostProcessor</h3><ol>
<li>InstantiationAwareBeanPostProcessor.postProcessBeforeInstantiation()</li>
<li>å®ä¾‹åŒ–</li>
<li>MergedBeanDefinitionPostProcessor.postProcessMergedBeanDefinition()</li>
<li>InstantiationAwareBeanPostProcessor.postProcessAfterInstantiation()</li>
<li>è‡ªåŠ¨æ³¨å…¥</li>
<li>InstantiationAwareBeanPostProcessor.postProcessProperties()</li>
<li>Awareå¯¹è±¡</li>
<li>BeanPostProcessor.postProcessBeforeInitialization()</li>
<li>åˆå§‹åŒ–</li>
<li>BeanPostProcessor.postProcessAfterInitialization()</li>
</ol>
]]></content>
      <categories>
        <category>æºç è§£æ</category>
      </categories>
      <tags>
        <tag>spring</tag>
        <tag>bean</tag>
      </tags>
  </entry>
  <entry>
    <title>nvm-nodeç‰ˆæœ¬ç®¡ç†</title>
    <url>/posts/1/</url>
    <content><![CDATA[<h1 id="nvm-nodeç‰ˆæœ¬ç®¡ç†"><a href="#nvm-nodeç‰ˆæœ¬ç®¡ç†" class="headerlink" title="nvm-nodeç‰ˆæœ¬ç®¡ç†"></a>nvm-nodeç‰ˆæœ¬ç®¡ç†</h1><p>**<code>Github</code>**ï¼š<a href="https://github.com/nvm-sh/nvm" title=" https://github.com/nvm-sh/nvm"> https://github.com/nvm-sh/nvm</a></p>
<p>**<code>å…¶ä»–æ–‡æ¡£</code>**ï¼š<a href="https://nvm.uihtm.com/#nvm-mac" title="https://nvm.uihtm.com/#nvm-mac">https://nvm.uihtm.com/#nvm-mac</a></p>
<h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><p><code>nvm</code>å…¨è‹±æ–‡ä¹Ÿå«<code>Node Version Manager</code>ï¼Œæ˜¯ä¸€ä¸ªnodejsçš„ç‰ˆæœ¬ç®¡ç†å·¥å…·ã€‚<code>nvm</code>å’Œ<code>n</code>éƒ½æ˜¯<code>node.js</code>ç‰ˆæœ¬ç®¡ç†å·¥å…·ï¼Œä¸ºäº†è§£å†³node.jså„ç§ç‰ˆæœ¬å­˜åœ¨ä¸å…¼å®¹ç°è±¡å¯ä»¥é€šè¿‡å®ƒå¯ä»¥å®‰è£…å’Œåˆ‡æ¢ä¸åŒç‰ˆæœ¬çš„node.jsã€‚</p>
<p><code>nvm</code>å…è®¸æ‚¨é€šè¿‡å‘½ä»¤è¡Œå¿«é€Ÿå®‰è£…å’Œä½¿ç”¨ä¸åŒç‰ˆæœ¬çš„nodeï¼Œ</p>
<p><code>nvm</code> æ˜¯ä¸€ä¸ª<code>node.js</code> çš„ç‰ˆæœ¬ç®¡ç†å·¥å…·ï¼Œ æ”¯æŒå„ç§shell ï¼ˆ<code>sh</code>, <code>dash</code>, <code>ksh</code>, <code>zsh</code>, <code>bash</code>ï¼‰</p>
<h2 id="å®‰è£…å’Œæ›´æ–°"><a href="#å®‰è£…å’Œæ›´æ–°" class="headerlink" title="å®‰è£…å’Œæ›´æ–°"></a>å®‰è£…å’Œæ›´æ–°</h2><p>â€¼ï¸ä¸ç®¡æ€ä¹ˆå®‰è£… éƒ½æ˜¯å®Œæˆä¸¤ä»¶äº‹</p>
<ol>
<li>ä¸‹è½½ nvmä»“åº“ å¾—åˆ°ä¸€ä¸ª <code>.nvm </code>&#x20;</li>
<li>é…ç½® ç¯å¢ƒå˜é‡ ï¼Œ<ol>
<li><code>export NVM_DIR=&quot;$HOME/.nvm&quot;</code>     nvm ç›®å½•</li>
<li><code>[ -s &quot;$NVM_DIR/nvm.sh&quot; ] &amp;&amp; \. &quot;$NVM_DIR/nvm.sh&quot;</code>     åŠ è½½nvm</li>
<li><code>[ -s &quot;$NVM_DIR/bash_completion&quot; ] &amp;&amp; \. &quot;$NVM_DIR/bash_completion&quot; </code>   å‘½ä»¤è¡Œè‡ªåŠ¨è¡¥å…¨</li>
</ol>
</li>
</ol>
<h3 id="è„šæœ¬å®‰è£…å’Œæ›´æ–°"><a href="#è„šæœ¬å®‰è£…å’Œæ›´æ–°" class="headerlink" title="è„šæœ¬å®‰è£…å’Œæ›´æ–°"></a>è„šæœ¬å®‰è£…å’Œæ›´æ–°</h3><p>éœ€è¦å®‰è£…ä¸€ä¸ªè„šæœ¬ï¼Œå¯ä»¥æ‰‹åŠ¨<a href="https://github.com/nvm-sh/nvm/blob/v0.39.7/install.sh" title="ä¸‹è½½">ä¸‹è½½</a>ç„¶åè¿è¡Œè„šæœ¬ï¼Œä¹Ÿå¯ä»¥æ‰§è¡Œ <code>curl</code> æˆ–è€… <code>wget</code>å‘½ä»¤æ¥å®‰è£…</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.7/install.sh | bash</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wget -qO- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.7/install.sh | bash</span><br></pre></td></tr></table></figure>

<p>è¿è¡Œä¸Šé¢çš„å‘½ä»¤ä¼šä¸‹è½½è„šæœ¬å¹¶è¿è¡Œï¼Œ è¿™ä¸ªè„šæœ¬ä¼šclone nvmä»“åº“åˆ° <code>~/.nmv</code> , å¹¶ä¸”ä¼šæ·»åŠ  ä¸€æ®µä»£ç åˆ° é…ç½®æ–‡ä»¶ä¸­(<code>~/.bash_profile</code>, <code>~/.zshrc</code>, <code>~/.profile</code>, or <code>~/.bashrc</code>)ï¼Œ æˆ‘ç”¨çš„æ˜¯<code>zsh</code></p>
<p>æ‰€ä»¥å†™åˆ°äº† <code>~/.zshrc</code> ä¸­</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">export</span> NVM_DIR=<span class="string">&quot;<span class="subst">$([ -z <span class="string">&quot;<span class="variable">$&#123;XDG_CONFIG_HOME-&#125;</span>&quot;</span> ] &amp;&amp; printf %s <span class="string">&quot;<span class="variable">$&#123;HOME&#125;</span>/.nvm&quot;</span> || printf %s <span class="string">&quot;<span class="variable">$&#123;XDG_CONFIG_HOME&#125;</span>/nvm&quot;</span>)</span>&quot;</span></span><br><span class="line">[ -s <span class="string">&quot;<span class="variable">$NVM_DIR</span>/nvm.sh&quot;</span> ] &amp;&amp; \. <span class="string">&quot;<span class="variable">$NVM_DIR</span>/nvm.sh&quot;</span> <span class="comment"># This loads nvm</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ä½¿é…ç½®ç”Ÿæ•ˆ</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">source</span> ~/.zshrc</span><br></pre></td></tr></table></figure>

<h3 id="å®Œå…¨æ‰‹åŠ¨å®‰è£…"><a href="#å®Œå…¨æ‰‹åŠ¨å®‰è£…" class="headerlink" title="å®Œå…¨æ‰‹åŠ¨å®‰è£…"></a>å®Œå…¨æ‰‹åŠ¨å®‰è£…</h3><p><code>export NVM_DIR=&quot;$HOME/.nvm&quot;</code> æŒ‡å®š å®‰è£…ç›®å½•ï¼Œ æ¯”å¦‚æˆ‘å®‰è£…åˆ°äº† <code>/opt/middleware/nvm</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">export</span> NVM_DIR=<span class="string">&quot;<span class="variable">$HOME</span>/.nvm&quot;</span> &amp;&amp; (</span><br><span class="line">  git <span class="built_in">clone</span> https://github.com/nvm-sh/nvm.git <span class="string">&quot;<span class="variable">$NVM_DIR</span>&quot;</span></span><br><span class="line">  <span class="built_in">cd</span> <span class="string">&quot;<span class="variable">$NVM_DIR</span>&quot;</span></span><br><span class="line">  git checkout `git describe --abbrev=0 --tags --match <span class="string">&quot;v[0-9]*&quot;</span> $(git rev-list --tags --max-count=1)`</span><br><span class="line">) &amp;&amp; \. <span class="string">&quot;<span class="variable">$NVM_DIR</span>/nvm.sh&quot;</span></span><br></pre></td></tr></table></figure>

<p>æ·»åŠ é…ç½®åˆ°  <code>~/.bashrc</code>, <code>~/.profile</code>, or <code>~/.zshrc</code> ç­‰é…ç½®æ–‡ä»¶ä¸­</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">export</span> NVM_DIR=<span class="string">&quot;<span class="variable">$HOME</span>/.nvm&quot;</span></span><br><span class="line">[ -s <span class="string">&quot;<span class="variable">$NVM_DIR</span>/nvm.sh&quot;</span> ] &amp;&amp; \. <span class="string">&quot;<span class="variable">$NVM_DIR</span>/nvm.sh&quot;</span> <span class="comment"># This loads nvm</span></span><br><span class="line">[ -s <span class="string">&quot;<span class="variable">$NVM_DIR</span>/bash_completion&quot;</span> ] &amp;&amp; \. <span class="string">&quot;<span class="variable">$NVM_DIR</span>/bash_completion&quot;</span>  <span class="comment"># This loads nvm bash_completion</span></span><br></pre></td></tr></table></figure>

<p>ä½¿é…ç½®ç”Ÿæ•ˆ</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">source</span> ~/.zshrc</span><br></pre></td></tr></table></figure>

<h3 id="æ‰‹åŠ¨å‡çº§"><a href="#æ‰‹åŠ¨å‡çº§" class="headerlink" title="æ‰‹åŠ¨å‡çº§"></a>æ‰‹åŠ¨å‡çº§</h3><p>æ›´æ–°nvm ä»“åº“å³å¯</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">(</span><br><span class="line">  <span class="built_in">cd</span> <span class="string">&quot;<span class="variable">$NVM_DIR</span>&quot;</span></span><br><span class="line">  git fetch --tags origin</span><br><span class="line">  git checkout `git describe --abbrev=0 --tags --match <span class="string">&quot;v[0-9]*&quot;</span> $(git rev-list --tags --max-count=1)`</span><br><span class="line">) &amp;&amp; \. <span class="string">&quot;<span class="variable">$NVM_DIR</span>/nvm.sh&quot;</span></span><br></pre></td></tr></table></figure>

<h2 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h2><p>â€¼ï¸â€¼ï¸åœ¨å®‰è£…<code>node</code>çš„æ—¶å€™ï¼Œnvm å°†ä¸åŒçš„ <code>node</code> ç‰ˆæœ¬å­˜å‚¨åˆ° <code>~/.nvm/&lt;version&gt;/</code> ä¸‹ï¼Œç„¶åä¿®æ”¹ <code>$PATH</code>ï¼Œå°†æŒ‡å®šç‰ˆæœ¬çš„ <code>node</code> è·¯å¾„åŠ å…¥ï¼Œè¿™æ ·æˆ‘ä»¬è°ƒç”¨çš„ <code>node</code> å‘½ä»¤å³æ˜¯ä½¿ç”¨æŒ‡å®šç‰ˆæœ¬çš„ node</p>
<p><code>nvm</code> çš„å…¨å±€æ¨¡å—å­˜åœ¨äºå„è‡ªç‰ˆæœ¬çš„æ²™ç®±ä¸­ï¼Œåˆ‡æ¢ç‰ˆæœ¬åéœ€è¦<code>é‡æ–°å®‰è£…</code>ï¼Œ<code>ä¸åŒç‰ˆæœ¬é—´ä¹Ÿä¸å­˜åœ¨ä»»ä½•å†²çª</code></p>
<h3 id="å¸¸ç”¨å‘½ä»¤"><a href="#å¸¸ç”¨å‘½ä»¤" class="headerlink" title="å¸¸ç”¨å‘½ä»¤"></a>å¸¸ç”¨å‘½ä»¤</h3><ul>
<li><code>nvm instlal node</code>   å®‰è£…æœ€æ–°ç‰ˆæœ¬</li>
<li><code>nvm instlal --lts</code>   å®‰è£…æœ€æ–°çš„é•¿æœŸæ”¯æŒç‰ˆæœ¬</li>
<li><code>nvm install [nodeç‰ˆæœ¬å·] </code>æŒ‡å®šç‰ˆæœ¬å®‰è£…ï¼Œå¯ä»¥ä¸å†™å…¨</li>
<li><code>nvm ls-remote </code> æŸ¥çœ‹å¯ç”¨ç‰ˆæœ¬</li>
<li><code>nvm ls-remote --lts </code> æŸ¥çœ‹é•¿æœŸæ”¯æŒç‰ˆæœ¬å¯ç”¨ç‰ˆæœ¬</li>
<li><code>nvm use [nodeç‰ˆæœ¬å·]</code>  åˆ‡æ¢åˆ°æŒ‡å®šç‰ˆæœ¬ nodeï¼Œå¯ä»¥ä¸å†™å…¨</li>
<li><code>nvm use node</code> ä½¿ç”¨å·²å®‰è£…çš„æœ€æ–°ç‰ˆæœ¬</li>
<li><code>nvm current</code>  æŸ¥çœ‹å½“å‰ç‰ˆæœ¬</li>
<li><code>nvm ls </code>åˆ—å‡ºæ‰€æœ‰å·²å®‰è£…çš„ node ç‰ˆæœ¬</li>
<li><code>nvm which [nodeç‰ˆæœ¬å·]</code>  æŸ¥çœ‹æŒ‡å®šç‰ˆæœ¬nodeçš„å®‰è£…ç›®å½•</li>
</ul>
<h3 id="å®‰è£…åŒ…ç®¡ç†å™¨"><a href="#å®‰è£…åŒ…ç®¡ç†å™¨" class="headerlink" title="å®‰è£…åŒ…ç®¡ç†å™¨"></a>å®‰è£…åŒ…ç®¡ç†å™¨</h3><p>npm nodeå®‰è£…æ—¶å·²æœ‰</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install -g pnpm</span><br><span class="line"></span><br><span class="line">npm install -g yarn</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æŸ¥çœ‹ pnpm yarnå®‰è£…ä½ç½®</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">âœ  ~ <span class="built_in">which</span> pnpm                                                      [23:35:04]</span><br><span class="line">/opt/middleware/nvm/versions/node/v20.11.1/bin/pnpm</span><br><span class="line">âœ  ~ <span class="built_in">which</span> yarn                                                      [23:35:08]</span><br><span class="line">/opt/middleware/nvm/versions/node/v20.11.1/bin/yarn</span><br></pre></td></tr></table></figure>

<h3 id="ä½¿ç”¨å›½å†…é•œåƒï¼Œå®‰è£…nodeç‰ˆæœ¬"><a href="#ä½¿ç”¨å›½å†…é•œåƒï¼Œå®‰è£…nodeç‰ˆæœ¬" class="headerlink" title="ä½¿ç”¨å›½å†…é•œåƒï¼Œå®‰è£…nodeç‰ˆæœ¬"></a>ä½¿ç”¨å›½å†…é•œåƒï¼Œå®‰è£…nodeç‰ˆæœ¬</h3><h5 id="é˜¿é‡Œäº‘é•œåƒ"><a href="#é˜¿é‡Œäº‘é•œåƒ" class="headerlink" title="é˜¿é‡Œäº‘é•œåƒ"></a>é˜¿é‡Œäº‘é•œåƒ</h5><p>nvm npm_mirror <a href="https://npmmirror.com/mirrors/npm/" title="https://npmmirror.com/mirrors/npm/">https://npmmirror.com/mirrors/npm/</a></p>
<p>nvm node_mirror <a href="https://npmmirror.com/mirrors/node/" title="https://npmmirror.com/mirrors/node/">https://npmmirror.com/mirrors/node/</a></p>
<h5 id="è…¾è®¯äº‘é•œåƒ"><a href="#è…¾è®¯äº‘é•œåƒ" class="headerlink" title="è…¾è®¯äº‘é•œåƒ"></a>è…¾è®¯äº‘é•œåƒ</h5><p>nvm npm_mirror <a href="http://mirrors.cloud.tencent.com/npm/" title="http://mirrors.cloud.tencent.com/npm/">http://mirrors.cloud.tencent.com/npm/</a></p>
<p>nvm node_mirror <a href="http://mirrors.cloud.tencent.com/nodejs-release/" title="http://mirrors.cloud.tencent.com/nodejs-release/">http://mirrors.cloud.tencent.com/nodejs-release/</a></p>
<h2 id="ç¯å¢ƒå˜é‡"><a href="#ç¯å¢ƒå˜é‡" class="headerlink" title="ç¯å¢ƒå˜é‡"></a>ç¯å¢ƒå˜é‡</h2><ul>
<li><code>NVM_DIR</code> - nvmâ€™s installation directory.</li>
<li><code>NVM_BIN</code> - where node, npm, and global packages for the active version of node are installed.</li>
<li><code>NVM_INC</code> - nodeâ€™s include file directory (useful for building C&#x2F;C++ addons for node).</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">âœ  ~ <span class="built_in">echo</span> <span class="variable">$NVM_DIR</span>                                                   [23:35:11]</span><br><span class="line">/opt/middleware/nvm</span><br><span class="line">âœ  ~ <span class="built_in">echo</span> <span class="variable">$NVM_BIN</span>                                                   [23:35:35]</span><br><span class="line">/opt/middleware/nvm/versions/node/v20.11.1/bin</span><br><span class="line">âœ  ~ <span class="built_in">echo</span> <span class="variable">$NVM_INC</span>                                                   [23:35:46]</span><br><span class="line">/opt/middleware/nvm/versions/node/v20.11.1/include/node</span><br></pre></td></tr></table></figure>

<h2 id="å¸è½½"><a href="#å¸è½½" class="headerlink" title="å¸è½½"></a>å¸è½½</h2><p>åˆ é™¤ <code>.nvm </code>æ•´ä¸ªç›®å½•&#x20;</p>
<p>åˆ é™¤é…ç½®æ–‡ä»¶ä¸­æ·»åŠ çš„ä»£ç </p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">export</span> NVM_DIR=<span class="string">&quot;<span class="variable">$HOME</span>/.nvm&quot;</span></span><br><span class="line">[ -s <span class="string">&quot;<span class="variable">$NVM_DIR</span>/nvm.sh&quot;</span> ] &amp;&amp; \. <span class="string">&quot;<span class="variable">$NVM_DIR</span>/nvm.sh&quot;</span> <span class="comment"># This loads nvm</span></span><br><span class="line">[[ -r <span class="variable">$NVM_DIR</span>/bash_completion ]] &amp;&amp; \. <span class="variable">$NVM_DIR</span>/bash_completion</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>nodejs</tag>
        <tag>npm</tag>
        <tag>nvm</tag>
        <tag>pnpm</tag>
        <tag>yarn</tag>
      </tags>
  </entry>
</search>
